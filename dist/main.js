/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={168:e=>{function t(e){var t,r,n=e[0]/255,a=e[1]/255,i=e[2]/255,o=Math.min(n,a,i),f=Math.max(n,a,i),u=f-o;return f==o?t=0:n==f?t=(a-i)/u:a==f?t=2+(i-n)/u:i==f&&(t=4+(n-a)/u),(t=Math.min(60*t,360))<0&&(t+=360),r=(o+f)/2,[t,100*(f==o?0:r<=.5?u/(f+o):u/(2-f-o)),100*r]}function n(e){var t,r,n=e[0],a=e[1],i=e[2],o=Math.min(n,a,i),f=Math.max(n,a,i),u=f-o;return r=0==f?0:u/f*1e3/10,f==o?t=0:n==f?t=(a-i)/u:a==f?t=2+(i-n)/u:i==f&&(t=4+(n-a)/u),(t=Math.min(60*t,360))<0&&(t+=360),[t,r,f/255*1e3/10]}function a(e){var r=e[0],n=e[1],a=e[2];return[t(e)[0],1/255*Math.min(r,Math.min(n,a))*100,100*(a=1-1/255*Math.max(r,Math.max(n,a)))]}function i(e){var t,r=e[0]/255,n=e[1]/255,a=e[2]/255;return[100*((1-r-(t=Math.min(1-r,1-n,1-a)))/(1-t)||0),100*((1-n-t)/(1-t)||0),100*((1-a-t)/(1-t)||0),100*t]}function o(e){return A[JSON.stringify(e)]}function f(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*t+.7152*r+.0722*n),100*(.0193*t+.1192*r+.9505*n)]}function u(e){var t=f(e),r=t[0],n=t[1],a=t[2];return n/=100,a/=108.883,r=(r/=95.047)>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(r-n),200*(n-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]}function s(e){var t,r,n,a,i,o=e[0]/360,f=e[1]/100,u=e[2]/100;if(0==f)return[i=255*u,i,i];t=2*u-(r=u<.5?u*(1+f):u+f-u*f),a=[0,0,0];for(var s=0;s<3;s++)(n=o+1/3*-(s-1))<0&&n++,n>1&&n--,i=6*n<1?t+6*(r-t)*n:2*n<1?r:3*n<2?t+(r-t)*(2/3-n)*6:t,a[s]=255*i;return a}function c(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,a=Math.floor(t)%6,i=t-Math.floor(t),o=255*n*(1-r),f=255*n*(1-r*i),u=255*n*(1-r*(1-i));switch(n*=255,a){case 0:return[n,u,o];case 1:return[f,n,o];case 2:return[o,n,u];case 3:return[o,f,n];case 4:return[u,o,n];case 5:return[n,o,f]}}function l(e){var t,n,a,i,o=e[0]/360,f=e[1]/100,u=e[2]/100,s=f+u;switch(s>1&&(f/=s,u/=s),a=6*o-(t=Math.floor(6*o)),0!=(1&t)&&(a=1-a),i=f+a*((n=1-u)-f),t){default:case 6:case 0:r=n,g=i,b=f;break;case 1:r=i,g=n,b=f;break;case 2:r=f,g=n,b=i;break;case 3:r=f,g=i,b=n;break;case 4:r=i,g=f,b=n;break;case 5:r=n,g=f,b=i}return[255*r,255*g,255*b]}function p(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,a=e[3]/100;return[255*(1-Math.min(1,t*(1-a)+a)),255*(1-Math.min(1,r*(1-a)+a)),255*(1-Math.min(1,n*(1-a)+a))]}function d(e){var t,r,n,a=e[0]/100,i=e[1]/100,o=e[2]/100;return r=-.9689*a+1.8758*i+.0415*o,n=.0557*a+-.204*i+1.057*o,t=(t=3.2406*a+-1.5372*i+-.4986*o)>.0031308?1.055*Math.pow(t,1/2.4)-.055:t*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]}function m(e){var t=e[0],r=e[1],n=e[2];return r/=100,n/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]}function h(e){var t,r,n,a,i=e[0],o=e[1],f=e[2];return i<=8?a=(r=100*i/903.3)/100*7.787+16/116:(r=100*Math.pow((i+16)/116,3),a=Math.pow(r/100,1/3)),[t=t/95.047<=.008856?t=95.047*(o/500+a-16/116)/7.787:95.047*Math.pow(o/500+a,3),r,n=n/108.883<=.008859?n=108.883*(a-f/200-16/116)/7.787:108.883*Math.pow(a-f/200,3)]}function v(e){var t,r=e[0],n=e[1],a=e[2];return(t=360*Math.atan2(a,n)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(n*n+a*a),t]}function y(e){return d(h(e))}function x(e){var t,r=e[0],n=e[1];return t=e[2]/360*2*Math.PI,[r,n*Math.cos(t),n*Math.sin(t)]}function w(e){return k[e]}e.exports={rgb2hsl:t,rgb2hsv:n,rgb2hwb:a,rgb2cmyk:i,rgb2keyword:o,rgb2xyz:f,rgb2lab:u,rgb2lch:function(e){return v(u(e))},hsl2rgb:s,hsl2hsv:function(e){var t=e[0],r=e[1]/100,n=e[2]/100;return 0===n?[0,0,0]:[t,2*(r*=(n*=2)<=1?n:2-n)/(n+r)*100,(n+r)/2*100]},hsl2hwb:function(e){return a(s(e))},hsl2cmyk:function(e){return i(s(e))},hsl2keyword:function(e){return o(s(e))},hsv2rgb:c,hsv2hsl:function(e){var t,r,n=e[0],a=e[1]/100,i=e[2]/100;return t=a*i,[n,100*(t=(t/=(r=(2-a)*i)<=1?r:2-r)||0),100*(r/=2)]},hsv2hwb:function(e){return a(c(e))},hsv2cmyk:function(e){return i(c(e))},hsv2keyword:function(e){return o(c(e))},hwb2rgb:l,hwb2hsl:function(e){return t(l(e))},hwb2hsv:function(e){return n(l(e))},hwb2cmyk:function(e){return i(l(e))},hwb2keyword:function(e){return o(l(e))},cmyk2rgb:p,cmyk2hsl:function(e){return t(p(e))},cmyk2hsv:function(e){return n(p(e))},cmyk2hwb:function(e){return a(p(e))},cmyk2keyword:function(e){return o(p(e))},keyword2rgb:w,keyword2hsl:function(e){return t(w(e))},keyword2hsv:function(e){return n(w(e))},keyword2hwb:function(e){return a(w(e))},keyword2cmyk:function(e){return i(w(e))},keyword2lab:function(e){return u(w(e))},keyword2xyz:function(e){return f(w(e))},xyz2rgb:d,xyz2lab:m,xyz2lch:function(e){return v(m(e))},lab2xyz:h,lab2rgb:y,lab2lch:v,lch2lab:x,lch2xyz:function(e){return h(x(e))},lch2rgb:function(e){return y(x(e))}};var k={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},A={};for(var _ in k)A[JSON.stringify(k[_])]=_},85:(e,t,r)=>{var n=r(168),a=function(){return new s};for(var i in n){a[i+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),n[e](t)}}(i);var o=/(\w+)2(\w+)/.exec(i),f=o[1],u=o[2];(a[f]=a[f]||{})[u]=a[i]=function(e){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var r=n[e](t);if("string"==typeof r||void 0===r)return r;for(var a=0;a<r.length;a++)r[a]=Math.round(r[a]);return r}}(i)}var s=function(){this.convs={}};s.prototype.routeSpace=function(e,t){var r=t[0];return void 0===r?this.getValues(e):("number"==typeof r&&(r=Array.prototype.slice.call(t)),this.setValues(e,r))},s.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},s.prototype.getValues=function(e){var t=this.convs[e];if(!t){var r=this.space,n=this.convs[r];t=a[r][e](n),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach((function(e){s.prototype[e]=function(t){return this.routeSpace(e,arguments)}})),e.exports=a},578:e=>{e.exports=function(e,t){return(t="number"==typeof t?t:1/0)?function e(r,n){return r.reduce((function(r,a){return Array.isArray(a)&&n<t?r.concat(e(a,n+1)):r.concat(a)}),[])}(e,1):Array.isArray(e)?e.map((function(e){return e})):e}},448:e=>{var t=Array.isArray,r=Object.prototype.toString;e.exports=t||function(e){return!!e&&"[object Array]"==r.call(e)}},738:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},981:e=>{"use strict";var t=String.prototype.valueOf,r=Object.prototype.toString,n="function"==typeof Symbol&&!!Symbol.toStringTag;e.exports=function(e){return"string"==typeof e||"object"==typeof e&&(n?function(e){try{return t.call(e),!0}catch(e){return!1}}(e):"[object String]"===r.call(e))}},401:(e,t,r)=>{var n=r(738),a=Object.prototype.toString;e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if(!0===e||!1===e||e instanceof Boolean)return"boolean";if("string"==typeof e||e instanceof String)return"string";if("number"==typeof e||e instanceof Number)return"number";if("function"==typeof e||e instanceof Function)return"function";if(void 0!==Array.isArray&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=a.call(e);return"[object RegExp]"===t?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":n(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},427:(e,t,r)=>{var n=r(85);e.exports=function(e){var t,r,a,i;if(t=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(e)){var o=t[1],f="cmyk"===(u=o.replace(/a$/,""))?4:3;r=n[u],a=t[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map((function(e,t){return/%$/.test(e)&&t===f?parseFloat(e)/100:(/%$/.test(e),parseFloat(e))})),o===u&&a.push(1),i=void 0===a[f]?1:a[f],a=a.slice(0,f),r[u]=function(){return a}}else if(/^#[A-Fa-f0-9]+$/.test(e)){var u;f=(u=e.replace(/^#/,"")).length,r=n.rgb,a=(a=u.split(3===f?/(.)/:/(..)/)).filter(Boolean).map((function(e){return 3===f?parseInt(e+e,16):parseInt(e,16)})),i=1,r.rgb=function(){return a},a[0]||(a[0]=0),a[1]||(a[1]=0),a[2]||(a[2]=0)}else(r=n.keyword).keyword=function(){return e},a=e,i=1;var s={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{s.rgb=r.rgb(a)}catch(e){}try{s.hsl=r.hsl(a)}catch(e){}try{s.hsv=r.hsv(a)}catch(e){}try{s.cmyk=r.cmyk(a)}catch(e){}try{s.keyword=r.keyword(a)}catch(e){}return s.rgb&&(s.hex="#"+s.rgb.map((function(e){var t=e.toString(16);return 1===t.length?"0"+t:t})).join("")),s.rgb&&(s.rgba=s.rgb.concat(i)),s.hsl&&(s.hsla=s.hsl.concat(i)),s.hsv&&(s.hsva=s.hsv.concat(i)),s.cmyk&&(s.cmyka=s.cmyk.concat(i)),s}},878:(e,t,r)=>{var n=r(427),a=r(966),i=r(981),o=r(448),f=r(816),u=r(932);function s(e,t){if(!(this instanceof s))return new s(e,t);var c=this;(t=t||{}).background=t.background||[.5,.5,.5],t.size=a(t.size)?t.size:10,t.padding=a(t.padding)?t.padding:2,i(t.background)&&(t.background=n(t.background).rgb.map((function(e){return e/255}))),o(e[0])&&3!==e[0].length&&(t.rows=e.length,t.columns=e[0].length),t.rows&&t.columns||(t.rows=t.columns=Math.round(Math.sqrt(e.length)));var l=t.columns*t.size+(t.columns+1)*t.padding,p=t.rows*t.size+(t.rows+1)*t.padding,d=document.createElement("canvas");d.width=l,d.height=p,t.root&&t.root.appendChild(d);var m=t.formatted?e:f(e),h=u(t.rows,t.columns,2*t.padding/l,2*t.size/l,l/p),b=r(543)(d),g=b({vert:`\n    precision mediump float;\n    attribute vec2 position;\n    attribute vec3 color;\n    varying vec3 vcolor;\n    void main() {\n      gl_PointSize = float(${t.size});\n      gl_Position = vec4(position.x, position.y, 0.0, 1.0);\n      vcolor = color;\n    }\n    `,frag:"\n    precision mediump float;\n    varying vec3 vcolor;\n    void main() {\n      gl_FragColor = vec4(vcolor, 1.0);\n    }\n    ",attributes:{position:b.prop("position"),color:b.prop("color")},primitive:"points",count:m.length}),v={position:b.buffer(h),color:b.buffer(m)},y=function(e,r){b.clear({color:t.background.concat([1])}),g({position:e,color:r})};y(v.position,v.color),c._buffer=v,c._draw=y,c._formatted=t.formatted,c.canvas=d,c.frame=b.frame}s.prototype.update=function(e){var t=this,r=t._formatted?e:f(e);t._draw(t._buffer.position,t._buffer.color(r))},e.exports=s},966:(e,t,r)=>{"use strict";var n=r(401);e.exports=function(e){var t=n(e);if("number"!==t&&"string"!==t)return!1;var r=+e;return r-r+1>=0&&""!==e}},816:(e,t,r)=>{var n=r(578),a=r(448),i=r(966),o=r(981),f=r(427);e.exports=function(e){return e=a(e[0])&&3!==e[0].length?n(e,1):e,i(e[0])&&(e=e.map((function(e){return[e,e,e]}))),o(e[0])&&(e=e.map((function(e){return f(e).rgb.map((function(e){return e/255}))}))),e}},932:e=>{e.exports=function(e,t,r,n,a){for(var i=[],o=0;o<e;o++)for(var f=0;f<t;f++){var u=a*(o*(r+n)+r+n/2)-1,s=1-(f*(r+n)+r+n/2);i.push([s,u])}return i.reverse()}},18:e=>{function t(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}e.exports=function(e,r,n,a,i){for(var o=n.maxAttributes,f=new Array(o),u=0;u<o;++u)f[u]=new t;return{Record:t,scope:{},state:f}}},661:(e,t,r)=>{var n=r(343),a=r(809),i=r(533),o=r(326),f=r(256),u=r(486),s=r(985),c=r(925),l=5126,p=[];function d(e){return 0|u[Object.prototype.toString.call(e)]}function m(e,t){for(var r=0;r<t.length;++r)e[r]=t[r]}function h(e,t,r,n,a,i,o){for(var f=0,u=0;u<r;++u)for(var s=0;s<n;++s)e[f++]=t[a*u+i*s+o]}function b(e,t,r){for(var n=0,a=0;a<t.length;++a)for(var i=t[a],o=0;o<r;++o)e[n++]=i[o]}p[5120]=1,p[5122]=2,p[5124]=4,p[5121]=1,p[5123]=2,p[5125]=4,p[5126]=4,e.exports=function(e,t,r){var u=0,g={};function v(t){this.id=u++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,r.profile&&(this.stats={size:0})}v.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},v.prototype.destroy=function(){k(this)};var y=[];function x(t,r,n){t.byteLength=r.byteLength,e.bufferData(t.type,r,n)}function w(e,t,r,o,u){var s;if(e.usage=r,Array.isArray(t)){if(e.dtype=o||l,t.length>0)if(Array.isArray(t[0]))e.dimension=t[0].length,b(s=f.allocType(e.dtype,t.length*e.dimension),t,e.dimension),x(e,s,r),f.freeType(s);else if("number"==typeof t[0]){e.dimension=u;var c=f.allocType(e.dtype,t.length);m(c,t),x(e,c,r),f.freeType(c)}else a(t[0])?(e.dimension=t[0].length,e.dtype=o||d(t[0])||l,b(s=f.allocType(e.dtype,t.length*e.dimension),t,e.dimension),x(e,s,r),f.freeType(s)):n.raise("invalid buffer data")}else if(a(t))e.dtype=o||d(t),e.dimension=u,x(e,t,r);else if(i(t)){var p=t.shape,g=t.stride,v=t.offset,y=0,w=0,k=0,A=0;1===p.length?(y=p[0],w=1,k=g[0],A=0):2===p.length?(y=p[0],w=p[1],k=g[0],A=g[1]):n.raise("invalid shape"),e.dtype=o||d(t.data)||l,e.dimension=w;var _=f.allocType(e.dtype,y*w);h(_,t.data,y,w,k,A,v),x(e,_,r),f.freeType(_)}else n.raise("invalid buffer data")}function k(r){t.bufferCount--;var a=r.buffer;n(a,"buffer must not be deleted already"),e.deleteBuffer(a),r.buffer=null,delete g[r.id]}return r.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(g).forEach((function(t){e+=g[t].stats.size})),e}),{create:function(o,u,l){t.bufferCount++;var y=new v(u);function x(t){var o=35044,f=null,u=0,l=0,d=1;return Array.isArray(t)||a(t)||i(t)?f=t:"number"==typeof t?u=0|t:t&&(n.type(t,"object","buffer arguments must be an object, a number or an array"),"data"in t&&(n(null===f||Array.isArray(f)||a(f)||i(f),"invalid data for buffer"),f=t.data),"usage"in t&&(n.parameter(t.usage,c,"invalid buffer usage"),o=c[t.usage]),"type"in t&&(n.parameter(t.type,s,"invalid buffer type"),l=s[t.type]),"dimension"in t&&(n.type(t.dimension,"number","invalid dimension"),d=0|t.dimension),"length"in t&&(n.nni(u,"buffer length must be a nonnegative integer"),u=0|t.length)),y.bind(),f?w(y,f,o,l,d):(e.bufferData(y.type,u,o),y.dtype=l||5121,y.usage=o,y.dimension=d,y.byteLength=u),r.profile&&(y.stats.size=y.byteLength*p[y.dtype]),x}function A(t,r){n(r+t.byteLength<=y.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+r+" to a buffer of size "+y.byteLength),e.bufferSubData(y.type,r,t)}return g[y.id]=y,l||x(o),x._reglType="buffer",x._buffer=y,x.subdata=function(e,t){var r=0|(t||0);if(y.bind(),Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var o=f.allocType(y.dtype,e.length);m(o,e),A(o,r),f.freeType(o)}else if(Array.isArray(e[0])||a(e[0])){var u=e[0].length,s=f.allocType(y.dtype,e.length*u);b(s,e,u),A(s,r),f.freeType(s)}else n.raise("invalid buffer data")}else if(a(e))A(e,r);else if(i(e)){var c=e.shape,l=e.stride,p=0,g=0,v=0,w=0;1===c.length?(p=c[0],g=1,v=l[0],w=0):2===c.length?(p=c[0],g=c[1],v=l[0],w=l[1]):n.raise("invalid shape");var k=Array.isArray(e.data)?y.dtype:d(e.data),_=f.allocType(k,p*g);h(_,e.data,p,g,v,w,e.offset),A(_,r),f.freeType(_)}else n.raise("invalid data for buffer subdata");return x},r.profile&&(x.stats=y.stats),x.destroy=function(){k(y)},x},createStream:function(e,t){var r=y.pop();return r||(r=new v(e)),r.bind(),w(r,t,35040,0,1),r},destroyStream:function(e){y.push(e)},clear:function(){o(g).forEach(k),y.forEach(k)},getBuffer:function(e){return e&&e._buffer instanceof v?e._buffer:null},_initBuffer:w}}},486:e=>{"use strict";e.exports=JSON.parse('{"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}')},985:e=>{"use strict";e.exports=JSON.parse('{"int8":5120,"int16":5122,"int32":5124,"uint8":5121,"uint16":5123,"uint32":5125,"float":5126,"float32":5126}')},220:e=>{"use strict";e.exports=JSON.parse('{"points":0,"point":0,"lines":1,"line":1,"line loop":2,"line strip":3,"triangles":4,"triangle":4,"triangle strip":5,"triangle fan":6}')},925:e=>{"use strict";e.exports=JSON.parse('{"static":35044,"dynamic":35048,"stream":35040}')},283:(e,t,r)=>{var n=r(343),a=r(914),i=r(954),o=r(809),f=r(533),u=r(783),s=r(414),c=r(220),l=r(985),p="xyzw".split(""),d="dither",m="blend.enable",h="blend.color",b="blend.equation",g="blend.func",v="depth.enable",y="depth.func",x="depth.range",w="depth.mask",k="colorMask",A="cull.enable",_="cull.face",S="frontFace",E="lineWidth",j="polygonOffset.enable",T="polygonOffset.offset",D="sample.alpha",O="sample.enable",C="sample.coverage",M="stencil.enable",z="stencil.mask",F="stencil.func",P="stencil.opFront",B="stencil.opBack",L="scissor.enable",I="scissor.box",R="viewport",W="profile",N="framebuffer",q="vert",H="frag",U="elements",G="primitive",Q="count",V="offset",Y="instances",$=N+"Width",J=N+"Height",X="drawingBufferWidth",K="drawingBufferHeight",Z=[g,b,F,P,B,C,R,I,T],ee=34962,te=5126,re=35664,ne=35665,ae=35666,ie=5124,oe=35667,fe=35668,ue=35669,se=35670,ce=35671,le=35672,pe=35673,de=35674,me=35675,he=35676,be=35678,ge=35680,ve=1028,ye=1029,xe=2305,we=7680,ke={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ae={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},_e={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Se={frag:35632,vert:35633},Ee={cw:2304,ccw:xe};function je(e){return Array.isArray(e)||o(e)||f(e)}function Te(e){return e.sort((function(e,t){return e===R?-1:t===R?1:e<t?-1:1}))}function De(e,t,r,n){this.thisDep=e,this.contextDep=t,this.propDep=r,this.append=n}function Oe(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Ce(e){return new De(!1,!1,!1,e)}function Me(e,t){var r=e.type;if(0===r){var n=e.data.length;return new De(!0,n>=1,n>=2,t)}if(4===r){var a=e.data;return new De(a.thisDep,a.contextDep,a.propDep,t)}return new De(3===r,2===r,1===r,t)}var ze=new De(!1,!1,!1,(function(){}));e.exports=function(e,t,r,o,f,Fe,Pe,Be,Le,Ie,Re,We,Ne,qe,He){var Ue=Ie.Record,Ge={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(Ge.min=32775,Ge.max=32776);var Qe=r.angle_instanced_arrays,Ve=r.webgl_draw_buffers,Ye={dirty:!0,profile:He.profile},$e={},Je=[],Xe={},Ke={};function Ze(e){return e.replace(".","_")}function et(e,t,r){var n=Ze(e);Je.push(e),$e[n]=Ye[n]=!!r,Xe[n]=t}function tt(e,t,r){var n=Ze(e);Je.push(e),Array.isArray(r)?(Ye[n]=r.slice(),$e[n]=r.slice()):Ye[n]=$e[n]=r,Ke[n]=t}et(d,3024),et(m,3042),tt(h,"blendColor",[0,0,0,0]),tt(b,"blendEquationSeparate",[32774,32774]),tt(g,"blendFuncSeparate",[1,0,1,0]),et(v,2929,!0),tt(y,"depthFunc",513),tt(x,"depthRange",[0,1]),tt(w,"depthMask",!0),tt(k,k,[!0,!0,!0,!0]),et(A,2884),tt(_,"cullFace",ye),tt(S,S,xe),tt(E,E,1),et(j,32823),tt(T,"polygonOffset",[0,0]),et(D,32926),et(O,32928),tt(C,"sampleCoverage",[1,!1]),et(M,2960),tt(z,"stencilMask",-1),tt(F,"stencilFunc",[519,0,-1]),tt(P,"stencilOpSeparate",[ve,we,we,we]),tt(B,"stencilOpSeparate",[ye,we,we,we]),et(L,3089),tt(I,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),tt(R,R,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var rt={gl:e,context:Ne,strings:t,next:$e,current:Ye,draw:We,elements:Fe,buffer:f,shader:Re,attributes:Ie.state,uniforms:Le,framebuffer:Be,extensions:r,timer:qe,isBufferArgs:je},nt={primTypes:c,compareFuncs:Ae,blendFuncs:ke,blendEquations:Ge,stencilOps:_e,glTypes:l,orientationType:Ee};n.optional((function(){rt.isArrayLike=u})),Ve&&(nt.backBuffer=[ye],nt.drawBuffer=i(o.maxDrawbuffers,(function(e){return 0===e?[0]:i(e,(function(e){return 36064+e}))})));var at=0;function it(){var e=a(),r=e.link,i=e.global;e.id=at++,e.batchId="0";var o=r(rt),f=e.shared={props:"a0"};Object.keys(rt).forEach((function(e){f[e]=i.def(o,".",e)})),n.optional((function(){e.CHECK=r(n),e.commandStr=n.guessCommand(),e.command=r(e.commandStr),e.assert=function(e,t,n){e("if(!(",t,"))",this.CHECK,".commandRaise(",r(n),",",this.command,");")}}));var u=e.next={},s=e.current={};Object.keys(Ke).forEach((function(e){Array.isArray(Ye[e])&&(u[e]=i.def(f.next,".",e),s[e]=i.def(f.current,".",e))}));var c=e.constants={};Object.keys(nt).forEach((function(e){c[e]=i.def(JSON.stringify(nt[e]))})),e.invoke=function(t,n){switch(n.type){case 0:var a=["this",f.context,f.props,e.batchId];return t.def(r(n.data),".call(",a.slice(0,Math.max(n.data.length+1,4)),")");case 1:return t.def(f.props,n.data);case 2:return t.def(f.context,n.data);case 3:return t.def("this",n.data);case 4:return n.data.append(e,t),n.data.ref}},e.attribCache={};var l={};return e.scopeAttrib=function(e){var n=t.id(e);if(n in l)return l[n];var a=Ie.scope[n];return a||(a=Ie.scope[n]=new Ue),l[n]=r(a)},e}function ot(e,r,a,s){var Z=function(e){var r=e.static,a=e.dynamic;n.optional((function(){var e=n.guessCommand(),t=[N,q,H,U,G,V,Q,Y,W].concat(Je);function i(r){Object.keys(r).forEach((function(r){n.command(t.indexOf(r)>=0,'unknown parameter "'+r+'"',e)}))}i(r),i(a)}));var f=function(e){var t=e.static,r=e.dynamic;if(N in t){var a=t[N];return a?(a=Be.getFramebuffer(a),n.command(a,"invalid framebuffer object"),Ce((function(e,t){var r=e.link(a),n=e.shared;t.set(n.framebuffer,".next",r);var i=n.context;return t.set(i,"."+$,r+".width"),t.set(i,"."+J,r+".height"),r}))):Ce((function(e,t){var r=e.shared;t.set(r.framebuffer,".next","null");var n=r.context;return t.set(n,"."+$,n+"."+X),t.set(n,"."+J,n+"."+K),"null"}))}if(N in r){var i=r[N];return Me(i,(function(e,t){var r=e.invoke(t,i),a=e.shared,o=a.framebuffer,f=t.def(o,".getFramebuffer(",r,")");n.optional((function(){e.assert(t,"!"+r+"||"+f,"invalid framebuffer object")})),t.set(o,".next",f);var u=a.context;return t.set(u,"."+$,f+"?"+f+".width:"+u+"."+X),t.set(u,"."+J,f+"?"+f+".height:"+u+"."+K),f}))}return null}(e),s=function(e,t){var r=e.static,a=e.dynamic;function i(e){if(e in r){var i=r[e];n.commandType(i,"object","invalid "+e);var o,f,u=!0,s=0|i.x,c=0|i.y;return n.command(s>=0&&c>=0,"invalid "+e),"width"in i?(o=0|i.width,n.command(o>0,"invalid "+e)):u=!1,"height"in i?(f=0|i.height,n.command(f>0,"invalid "+e)):u=!1,new De(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,(function(t,r){var a=t.shared.context,u=o;"width"in i?n.command(o>0,"invalid "+e):u=r.def(a,".",$,"-",s);var l=f;return"height"in i?n.command(f>0,"invalid "+e):l=r.def(a,".",J,"-",c),[s,c,u,l]}))}if(e in a){var l=a[e],p=Me(l,(function(t,r){var a=t.invoke(r,l);n.optional((function(){t.assert(r,a+"&&typeof "+a+'==="object"',"invalid "+e)}));var i=t.shared.context,o=r.def(a,".x|0"),f=r.def(a,".y|0"),u=r.def('"width" in ',a,"?",a,".width|0:","(",i,".",$,"-",o,")"),s=r.def('"height" in ',a,"?",a,".height|0:","(",i,".",J,"-",f,")");return n.optional((function(){t.assert(r,o+">=0&&"+f+">=0&&"+u+">0&&"+s+">0","invalid "+e)})),[o,f,u,s]}));return t&&(p.thisDep=p.thisDep||t.thisDep,p.contextDep=p.contextDep||t.contextDep,p.propDep=p.propDep||t.propDep),p}return t?new De(t.thisDep,t.contextDep,t.propDep,(function(e,t){var r=e.shared.context;return[0,0,t.def(r,".",$),t.def(r,".",J)]})):null}var o=i(R);if(o){var f=o;o=new De(o.thisDep,o.contextDep,o.propDep,(function(e,t){var r=f.append(e,t),n=e.shared.context;return t.set(n,".viewportWidth",r[2]),t.set(n,".viewportHeight",r[3]),r}))}return{viewport:o,scissor_box:i(I)}}(e,f),l=function(e){var t=e.static,r=e.dynamic,a=function(){if(U in t){var e=t[U];je(e)?e=Fe.getElements(Fe.create(e)):e&&(e=Fe.getElements(e),n.command(e,"invalid elements"));var a=Ce((function(t,r){if(e){var n=t.link(e);return t.ELEMENTS=n,n}return t.ELEMENTS=null,null}));return a.value=e,a}if(U in r){var i=r[U];return Me(i,(function(e,t){var r=e.shared,a=r.isBufferArgs,o=r.elements,f=e.invoke(t,i),u=t.def("null"),s=t.def(a,"(",f,")"),c=e.cond(s).then(u,"=",o,".createStream(",f,");").else(u,"=",o,".getElements(",f,");");return n.optional((function(){e.assert(c.else,"!"+f+"||"+u,"invalid elements")})),t.entry(c),t.exit(e.cond(s).then(o,".destroyStream(",u,");")),e.ELEMENTS=u,u}))}return null}();function i(e,i){if(e in t){var o=0|t[e];return n.command(!i||o>=0,"invalid "+e),Ce((function(e,t){return i&&(e.OFFSET=o),o}))}if(e in r){var f=r[e];return Me(f,(function(t,r){var a=t.invoke(r,f);return i&&(t.OFFSET=a,n.optional((function(){t.assert(r,a+">=0","invalid "+e)}))),a}))}return i&&a?Ce((function(e,t){return e.OFFSET="0",0})):null}var o=i(V,!0);return{elements:a,primitive:function(){if(G in t){var e=t[G];return n.commandParameter(e,c,"invalid primitve"),Ce((function(t,r){return c[e]}))}if(G in r){var i=r[G];return Me(i,(function(e,t){var r=e.constants.primTypes,a=e.invoke(t,i);return n.optional((function(){e.assert(t,a+" in "+r,"invalid primitive, must be one of "+Object.keys(c))})),t.def(r,"[",a,"]")}))}return a?Oe(a)?a.value?Ce((function(e,t){return t.def(e.ELEMENTS,".primType")})):Ce((function(){return 4})):new De(a.thisDep,a.contextDep,a.propDep,(function(e,t){var r=e.ELEMENTS;return t.def(r,"?",r,".primType:",4)})):null}(),count:function(){if(Q in t){var e=0|t[Q];return n.command("number"==typeof e&&e>=0,"invalid vertex count"),Ce((function(){return e}))}if(Q in r){var i=r[Q];return Me(i,(function(e,t){var r=e.invoke(t,i);return n.optional((function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")})),r}))}if(a){if(Oe(a)){if(a)return o?new De(o.thisDep,o.contextDep,o.propDep,(function(e,t){var r=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return n.optional((function(){e.assert(t,r+">=0","invalid vertex offset/element buffer too small")})),r})):Ce((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var f=Ce((function(){return-1}));return n.optional((function(){f.MISSING=!0})),f}var u=new De(a.thisDep||o.thisDep,a.contextDep||o.contextDep,a.propDep||o.propDep,(function(e,t){var r=e.ELEMENTS;return e.OFFSET?t.def(r,"?",r,".vertCount-",e.OFFSET,":-1"):t.def(r,"?",r,".vertCount:-1")}));return n.optional((function(){u.DYNAMIC=!0})),u}return null}(),instances:i(Y,!1),offset:o}}(e),p=function(e){var t=e.static,r=e.dynamic,a={};return Je.forEach((function(e){var f=Ze(e);function s(n,i){if(e in t){var o=n(t[e]);a[f]=Ce((function(){return o}))}else if(e in r){var u=r[e];a[f]=Me(u,(function(e,t){return i(e,t,e.invoke(t,u))}))}}switch(e){case A:case m:case d:case M:case v:case L:case j:case D:case O:case w:return s((function(t){return n.commandType(t,"boolean",e),t}),(function(t,r,a){return n.optional((function(){t.assert(r,"typeof "+a+'==="boolean"',"invalid flag "+e)})),a}));case y:return s((function(t){return n.commandParameter(t,Ae,"invalid "+e),Ae[t]}),(function(t,r,a){var i=t.constants.compareFuncs;return n.optional((function(){t.assert(r,a+" in "+i,"invalid "+e+", must be one of "+Object.keys(Ae))})),r.def(i,"[",a,"]")}));case x:return s((function(e){return n.command(u(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array"),e}),(function(e,t,r){return n.optional((function(){e.assert(t,e.shared.isArrayLike+"("+r+")&&"+r+".length===2&&typeof "+r+'[0]==="number"&&typeof '+r+'[1]==="number"&&'+r+"[0]<="+r+"[1]","depth range must be a 2d array")})),[t.def("+",r,"[0]"),t.def("+",r,"[1]")]}));case g:return s((function(e){n.commandType(e,"object","blend.func");var t="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,a="dstRGB"in e?e.dstRGB:e.dst,i="dstAlpha"in e?e.dstAlpha:e.dst;return n.commandParameter(t,ke,f+".srcRGB"),n.commandParameter(r,ke,f+".srcAlpha"),n.commandParameter(a,ke,f+".dstRGB"),n.commandParameter(i,ke,f+".dstAlpha"),[ke[t],ke[a],ke[r],ke[i]]}),(function(t,r,a){var i=t.constants.blendFuncs;function o(o,f){var u=r.def('"',o,f,'" in ',a,"?",a,".",o,f,":",a,".",o);return n.optional((function(){t.assert(r,u+" in "+i,"invalid "+e+"."+o+f+", must be one of "+Object.keys(ke))})),r.def(i,"[",u,"]")}n.optional((function(){t.assert(r,a+"&&typeof "+a+'==="object"',"invalid blend func, must be an object")}));var f=o("src","RGB"),u=o("src","Alpha");return[f,o("dst","RGB"),u,o("dst","Alpha")]}));case b:return s((function(t){return"string"==typeof t?(n.commandParameter(t,Ge,"invalid "+e),[Ge[t],Ge[t]]):"object"==typeof t?(n.commandParameter(t.rgb,Ge,e+".rgb"),n.commandParameter(t.alpha,Ge,e+".alpha"),[Ge[t.rgb],Ge[t.alpha]]):void n.commandRaise("invalid blend.equation")}),(function(t,r,a){var i=t.constants.blendEquations,o=r.def(),f=r.def(),u=t.cond("typeof ",a,'==="string"');return n.optional((function(){function r(e,r,n){t.assert(e,n+" in "+i,"invalid "+r+", must be one of "+Object.keys(Ge))}r(u.then,e,a),t.assert(u.else,a+"&&typeof "+a+'==="object"',"invalid "+e),r(u.else,e+".rgb",a+".rgb"),r(u.else,e+".alpha",a+".alpha")})),u.then(o,"=",f,"=",i,"[",a,"];"),u.else(o,"=",i,"[",a,".rgb];",f,"=",i,"[",a,".alpha];"),r(u),[o,f]}));case h:return s((function(e){return n.command(u(e)&&4===e.length,"blend.color must be a 4d array"),i(4,(function(t){return+e[t]}))}),(function(e,t,r){return n.optional((function(){e.assert(t,e.shared.isArrayLike+"("+r+")&&"+r+".length===4","blend.color must be a 4d array")})),i(4,(function(e){return t.def("+",r,"[",e,"]")}))}));case z:return s((function(e){return n.commandType(e,"number",f),0|e}),(function(e,t,r){return n.optional((function(){e.assert(t,"typeof "+r+'==="number"',"invalid stencil.mask")})),t.def(r,"|0")}));case F:return s((function(t){n.commandType(t,"object",f);var r=t.cmp||"keep",a=t.ref||0,i="mask"in t?t.mask:-1;return n.commandParameter(r,Ae,e+".cmp"),n.commandType(a,"number",e+".ref"),n.commandType(i,"number",e+".mask"),[Ae[r],a,i]}),(function(e,t,r){var a=e.constants.compareFuncs;return n.optional((function(){function n(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}n(r+"&&typeof ",r,'==="object"'),n('!("cmp" in ',r,")||(",r,".cmp in ",a,")")})),[t.def('"cmp" in ',r,"?",a,"[",r,".cmp]",":",we),t.def(r,".ref|0"),t.def('"mask" in ',r,"?",r,".mask|0:-1")]}));case P:case B:return s((function(t){n.commandType(t,"object",f);var r=t.fail||"keep",a=t.zfail||"keep",i=t.pass||"keep";return n.commandParameter(r,_e,e+".fail"),n.commandParameter(a,_e,e+".zfail"),n.commandParameter(i,_e,e+".pass"),[e===B?ye:ve,_e[r],_e[a],_e[i]]}),(function(t,r,a){var i=t.constants.stencilOps;function o(o){return n.optional((function(){t.assert(r,'!("'+o+'" in '+a+")||("+a+"."+o+" in "+i+")","invalid "+e+"."+o+", must be one of "+Object.keys(_e))})),r.def('"',o,'" in ',a,"?",i,"[",a,".",o,"]:",we)}return n.optional((function(){t.assert(r,a+"&&typeof "+a+'==="object"',"invalid "+e)})),[e===B?ye:ve,o("fail"),o("zfail"),o("pass")]}));case T:return s((function(e){n.commandType(e,"object",f);var t=0|e.factor,r=0|e.units;return n.commandType(t,"number",f+".factor"),n.commandType(r,"number",f+".units"),[t,r]}),(function(t,r,a){return n.optional((function(){t.assert(r,a+"&&typeof "+a+'==="object"',"invalid "+e)})),[r.def(a,".factor|0"),r.def(a,".units|0")]}));case _:return s((function(e){var t=0;return"front"===e?t=ve:"back"===e&&(t=ye),n.command(!!t,f),t}),(function(e,t,r){return n.optional((function(){e.assert(t,r+'==="front"||'+r+'==="back"',"invalid cull.face")})),t.def(r,'==="front"?',ve,":",ye)}));case E:return s((function(e){return n.command("number"==typeof e&&e>=o.lineWidthDims[0]&&e<=o.lineWidthDims[1],"invalid line width, must positive number between "+o.lineWidthDims[0]+" and "+o.lineWidthDims[1]),e}),(function(e,t,r){return n.optional((function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">="+o.lineWidthDims[0]+"&&"+r+"<="+o.lineWidthDims[1],"invalid line width")})),r}));case S:return s((function(e){return n.commandParameter(e,Ee,f),Ee[e]}),(function(e,t,r){return n.optional((function(){e.assert(t,r+'==="cw"||'+r+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(r+'==="cw"?2304:'+xe)}));case k:return s((function(e){return n.command(u(e)&&4===e.length,"color.mask must be length 4 array"),e.map((function(e){return!!e}))}),(function(e,t,r){return n.optional((function(){e.assert(t,e.shared.isArrayLike+"("+r+")&&"+r+".length===4","invalid color.mask")})),i(4,(function(e){return"!!"+r+"["+e+"]"}))}));case C:return s((function(e){n.command("object"==typeof e&&e,f);var t="value"in e?e.value:1,r=!!e.invert;return n.command("number"==typeof t&&t>=0&&t<=1,"sample.coverage.value must be a number between 0 and 1"),[t,r]}),(function(e,t,r){return n.optional((function(){e.assert(t,r+"&&typeof "+r+'==="object"',"invalid sample.coverage")})),[t.def('"value" in ',r,"?+",r,".value:1"),t.def("!!",r,".invert")]}))}})),a}(e),Z=function(e){var r=e.static,a=e.dynamic;function i(e){if(e in r){var i=t.id(r[e]);n.optional((function(){Re.shader(Se[e],i,n.guessCommand())}));var o=Ce((function(){return i}));return o.id=i,o}if(e in a){var f=a[e];return Me(f,(function(t,r){var a=t.invoke(r,f),i=r.def(t.shared.strings,".id(",a,")");return n.optional((function(){r(t.shared.shader,".shader(",Se[e],",",i,",",t.command,");")})),i}))}return null}var o,f=i(H),u=i(q),s=null;return Oe(f)&&Oe(u)?(s=Re.program(u.id,f.id),o=Ce((function(e,t){return e.link(s)}))):o=new De(f&&f.thisDep||u&&u.thisDep,f&&f.contextDep||u&&u.contextDep,f&&f.propDep||u&&u.propDep,(function(e,t){var r,a=e.shared.shader;r=f?f.append(e,t):t.def(a,".",H);var i=a+".program("+(u?u.append(e,t):t.def(a,".",q))+","+r;return n.optional((function(){i+=","+e.command})),t.def(i+")")})),{frag:f,vert:u,progVar:o,program:s}}(e);function ee(e){var t=s[e];t&&(p[e]=t)}ee(R),ee(Ze(I));var te=Object.keys(p).length>0;return{framebuffer:f,draw:l,shader:Z,state:p,dirty:te}}(e);return Z.profile=function(e){var t,r=e.static,n=e.dynamic;if(W in r){var a=!!r[W];(t=Ce((function(e,t){return a}))).enable=a}else if(W in n){var i=n[W];t=Me(i,(function(e,t){return e.invoke(t,i)}))}return t}(e),Z.uniforms=function(e){var t=e.static,r=e.dynamic,a={};return Object.keys(t).forEach((function(e){var r,o=t[e];if("number"==typeof o||"boolean"==typeof o)r=Ce((function(){return o}));else if("function"==typeof o){var f=o._reglType;"texture2d"===f||"textureCube"===f?r=Ce((function(e){return e.link(o)})):"framebuffer"===f||"framebufferCube"===f?(n(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"'),r=Ce((function(e){return e.link(o.color[0])}))):n.raise('invalid data for uniform "'+e+'"')}else u(o)?r=Ce((function(t){return t.global.def("[",i(o.length,(function(t){return n.command("number"==typeof o[t]||"boolean"==typeof o[t],"invalid uniform "+e),o[t]})),"]")})):n.commandRaise('invalid or missing data for uniform "'+e+'"');r.value=o,a[e]=r})),Object.keys(r).forEach((function(e){var t=r[e];a[e]=Me(t,(function(e,r){return e.invoke(r,t)}))})),a}(a),Z.attributes=function(e){var r=e.static,a=e.dynamic,i={};return Object.keys(r).forEach((function(e){var a=r[e],o=t.id(e),s=new Ue;if(je(a))s.state=1,s.buffer=f.getBuffer(f.create(a,ee,!1)),s.type=s.buffer.dtype;else{var c=f.getBuffer(a);if(c)s.state=1,s.buffer=c,s.type=c.dtype;else if(n.command("object"==typeof a&&a,"invalid data for attribute "+e),a.constant){var d=a.constant;s.buffer="null",s.state=2,"number"==typeof d?s.x=d:(n.command(u(d)&&d.length>0&&d.length<=4,"invalid constant for attribute "+e),p.forEach((function(e,t){t<d.length&&(s[e]=d[t])})))}else{c=f.getBuffer(a.buffer),n.command(!!c,'missing buffer for attribute "'+e+'"');var m=0|a.offset;n.command(m>=0,'invalid offset for attribute "'+e+'"');var h=0|a.stride;n.command(h>=0&&h<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]');var b=0|a.size;n.command(!("size"in a)||b>0&&b<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4');var g=!!a.normalized,v=0;"type"in a&&(n.commandParameter(a.type,l,"invalid type for attribute "+e),v=l[a.type]);var y=0|a.divisor;"divisor"in a&&(n.command(0===y||Qe,'cannot specify divisor for attribute "'+e+'", instancing not supported'),n.command(y>=0,'invalid divisor for attribute "'+e+'"')),n.optional((function(){var t=n.guessCommand(),r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(a).forEach((function(a){n.command(r.indexOf(a)>=0,'unknown parameter "'+a+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",t)}))})),s.buffer=c,s.state=1,s.size=b,s.normalized=g,s.type=v||c.dtype,s.offset=m,s.stride=h,s.divisor=y}}i[e]=Ce((function(e,t){var r=e.attribCache;if(o in r)return r[o];var n={isStream:!1};return Object.keys(s).forEach((function(e){n[e]=s[e]})),s.buffer&&(n.buffer=e.link(s.buffer)),r[o]=n,n}))})),Object.keys(a).forEach((function(e){var t=a[e];i[e]=Me(t,(function(r,a){var i=r.invoke(a,t),o=r.shared,f=o.isBufferArgs,u=o.buffer;n.optional((function(){r.assert(a,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+f+"("+i+")||"+u+".getBuffer("+i+")||"+u+".getBuffer("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+e+'"')}));var s={isStream:a.def(!1)},c=new Ue;c.state=1,Object.keys(c).forEach((function(e){s[e]=a.def(""+c[e])}));var l=s.buffer,d=s.type;function m(e){a(s[e],"=",i,".",e,"|0;")}return a("if(",f,"(",i,")){",s.isStream,"=true;",l,"=",u,".createStream(",ee,",",i,");",d,"=",l,".dtype;","}else{",l,"=",u,".getBuffer(",i,");","if(",l,"){",d,"=",l,".dtype;",'}else if("constant" in ',i,"){",s.state,"=",2,";","if(typeof "+i+'.constant === "number"){',s[p[0]],"=",i,".constant;",p.slice(1).map((function(e){return s[e]})).join("="),"=0;","}else{",p.map((function(e,t){return s[e]+"="+i+".constant.length>="+t+"?"+i+".constant["+t+"]:0;"})).join(""),"}}else{",l,"=",u,".getBuffer(",i,".buffer);",d,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",l,".dtype;",s.normalized,"=!!",i,".normalized;"),m("size"),m("offset"),m("stride"),m("divisor"),a("}}"),a.exit("if(",s.isStream,"){",u,".destroyStream(",l,");","}"),s}))})),i}(r),Z.context=function(e){var t=e.static,r=e.dynamic,n={};return Object.keys(t).forEach((function(e){var r=t[e];n[e]=Ce((function(e,t){return"number"==typeof r||"boolean"==typeof r?""+r:e.link(r)}))})),Object.keys(r).forEach((function(e){var t=r[e];n[e]=Me(t,(function(e,r){return e.invoke(r,t)}))})),n}(s),Z}function ft(e,t,r){var n=e.shared.context,a=e.scope();Object.keys(r).forEach((function(i){t.save(n,"."+i);var o=r[i];a(n,".",i,"=",o.append(e,t),";")})),t(a)}function ut(e,t,r,n){var a,i=e.shared,o=i.gl,f=i.framebuffer;Ve&&(a=t.def(i.extensions,".webgl_draw_buffers"));var u,s=e.constants,c=s.drawBuffer,l=s.backBuffer;u=r?r.append(e,t):t.def(f,".next"),n||t("if(",u,"!==",f,".cur){"),t("if(",u,"){",o,".bindFramebuffer(",36160,",",u,".framebuffer);"),Ve&&t(a,".drawBuffersWEBGL(",c,"[",u,".colorAttachments.length]);"),t("}else{",o,".bindFramebuffer(",36160,",null);"),Ve&&t(a,".drawBuffersWEBGL(",l,");"),t("}",f,".cur=",u,";"),n||t("}")}function st(e,t,r){var n=e.shared,a=n.gl,o=e.current,f=e.next,u=n.current,s=n.next,c=e.cond(u,".dirty");Je.forEach((function(t){var n,l,p=Ze(t);if(!(p in r.state))if(p in f){n=f[p],l=o[p];var d=i(Ye[p].length,(function(e){return c.def(n,"[",e,"]")}));c(e.cond(d.map((function(e,t){return e+"!=="+l+"["+t+"]"})).join("||")).then(a,".",Ke[p],"(",d,");",d.map((function(e,t){return l+"["+t+"]="+e})).join(";"),";"))}else{n=c.def(s,".",p);var m=e.cond(n,"!==",u,".",p);c(m),p in Xe?m(e.cond(n).then(a,".enable(",Xe[p],");").else(a,".disable(",Xe[p],");"),u,".",p,"=",n,";"):m(a,".",Ke[p],"(",n,");",u,".",p,"=",n,";")}})),0===Object.keys(r.state).length&&c(u,".dirty=false;"),t(c)}function ct(e,t,r,n){var a=e.shared,i=e.current,o=a.current,f=a.gl;Te(Object.keys(r)).forEach((function(a){var s=r[a];if(!n||n(s)){var c=s.append(e,t);if(Xe[a]){var l=Xe[a];Oe(s)?t(f,c?".enable(":".disable(",l,");"):t(e.cond(c).then(f,".enable(",l,");").else(f,".disable(",l,");")),t(o,".",a,"=",c,";")}else if(u(c)){var p=i[a];t(f,".",Ke[a],"(",c,");",c.map((function(e,t){return p+"["+t+"]="+e})).join(";"),";")}else t(f,".",Ke[a],"(",c,");",o,".",a,"=",c,";")}}))}function lt(e,t){Qe&&!e.instancing&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function pt(e,t,r,n,a){var i,o,f,u=e.shared,s=e.stats,c=u.current,l=u.timer,p=r.profile;function d(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function m(e){e(i=t.def(),"=",d(),";"),"string"==typeof a?e(s,".count+=",a,";"):e(s,".count++;"),qe&&(n?e(o=t.def(),"=",l,".getNumPendingQueries();"):e(l,".beginQuery(",s,");"))}function h(e){e(s,".cpuTime+=",d(),"-",i,";"),qe&&(n?e(l,".pushScopeStats(",o,",",l,".getNumPendingQueries(),",s,");"):e(l,".endQuery();"))}function b(e){var r=t.def(c,".profile");t(c,".profile=",e,";"),t.exit(c,".profile=",r,";")}if(p){if(Oe(p))return void(p.enable?(m(t),h(t.exit),b("true")):b("false"));b(f=p.append(e,t))}else f=t.def(c,".profile");var g=e.block();m(g),t("if(",f,"){",g,"}");var v=e.block();h(v),t.exit("if(",f,"){",v,"}")}function dt(e,t,r,a,i){var o=e.shared;a.forEach((function(a){var f,u=a.name,s=r.attributes[u];if(s){if(!i(s))return;f=s.append(e,t)}else{if(!i(ze))return;var c=e.scopeAttrib(u);n.optional((function(){e.assert(t,c+".state","missing attribute "+u)})),f={},Object.keys(new Ue).forEach((function(e){f[e]=t.def(c,".",e)}))}!function(r,n,a){var i=o.gl,f=t.def(r,".location"),u=t.def(o.attributes,"[",f,"]"),s=a.state,c=a.buffer,l=[a.x,a.y,a.z,a.w],d=["buffer","normalized","offset","stride"];function m(){t("if(!",u,".buffer){",i,".enableVertexAttribArray(",f,");}");var r,o=a.type;if(r=a.size?t.def(a.size,"||",n):n,t("if(",u,".type!==",o,"||",u,".size!==",r,"||",d.map((function(e){return u+"."+e+"!=="+a[e]})).join("||"),"){",i,".bindBuffer(",ee,",",c,".buffer);",i,".vertexAttribPointer(",[f,r,o,a.normalized,a.stride,a.offset],");",u,".type=",o,";",u,".size=",r,";",d.map((function(e){return u+"."+e+"="+a[e]+";"})).join(""),"}"),Qe){var s=a.divisor;t("if(",u,".divisor!==",s,"){",e.instancing,".vertexAttribDivisorANGLE(",[f,s],");",u,".divisor=",s,";}")}}function h(){t("if(",u,".buffer){",i,".disableVertexAttribArray(",f,");","}if(",p.map((function(e,t){return u+"."+e+"!=="+l[t]})).join("||"),"){",i,".vertexAttrib4f(",f,",",l,");",p.map((function(e,t){return u+"."+e+"="+l[t]+";"})).join(""),"}")}1===s?m():2===s?h():(t("if(",s,"===",1,"){"),m(),t("}else{"),h(),t("}"))}(e.link(a),function(e){switch(e){case re:case oe:case ce:return 2;case ne:case fe:case le:return 3;case ae:case ue:case pe:return 4;default:return 1}}(a.info.type),f)}))}function mt(e,r,a,o,f){for(var s,c=e.shared,l=c.gl,p=0;p<o.length;++p){var d,m=o[p],h=m.name,b=m.info.type,g=a.uniforms[h],v=e.link(m)+".location";if(g){if(!f(g))continue;if(Oe(g)){var y=g.value;if(n.command(null!=y,'missing uniform "'+h+'"'),b===be||b===ge){n.command("function"==typeof y&&(b===be&&("texture2d"===y._reglType||"framebuffer"===y._reglType)||b===ge&&("textureCube"===y._reglType||"framebufferCube"===y._reglType)),"invalid texture for uniform "+h);var x=e.link(y._texture||y.color[0]._texture);r(l,".uniform1i(",v,",",x+".bind());"),r.exit(x,".unbind();")}else if(b===de||b===me||b===he){n.optional((function(){n.command(u(y),"invalid matrix for uniform "+h),n.command(b===de&&4===y.length||b===me&&9===y.length||b===he&&16===y.length,"invalid length for matrix uniform "+h)}));var w=e.global.def("new Float32Array(["+Array.prototype.slice.call(y)+"])"),k=2;b===me?k=3:b===he&&(k=4),r(l,".uniformMatrix",k,"fv(",v,",false,",w,");")}else{switch(b){case te:n.commandType(y,"number","uniform "+h),s="1f";break;case re:n.command(u(y)&&2===y.length,"uniform "+h),s="2f";break;case ne:n.command(u(y)&&3===y.length,"uniform "+h),s="3f";break;case ae:n.command(u(y)&&4===y.length,"uniform "+h),s="4f";break;case se:n.commandType(y,"boolean","uniform "+h),s="1i";break;case ie:n.commandType(y,"number","uniform "+h),s="1i";break;case ce:case oe:n.command(u(y)&&2===y.length,"uniform "+h),s="2i";break;case le:case fe:n.command(u(y)&&3===y.length,"uniform "+h),s="3i";break;case pe:case ue:n.command(u(y)&&4===y.length,"uniform "+h),s="4i"}r(l,".uniform",s,"(",v,",",u(y)?Array.prototype.slice.call(y):y,");")}continue}d=g.append(e,r)}else{if(!f(ze))continue;d=r.def(c.uniforms,"[",t.id(h),"]")}b===be?r("if(",d,"&&",d,'._reglType==="framebuffer"){',d,"=",d,".color[0];","}"):b===ge&&r("if(",d,"&&",d,'._reglType==="framebufferCube"){',d,"=",d,".color[0];","}"),n.optional((function(){function t(t,n){e.assert(r,t,'bad data for uniform "'+h+'".  '+n)}function n(e){t("typeof "+d+'==="'+e+'"',"invalid type, expected "+e)}function a(e,r){t(c.isArrayLike+"("+d+")&&"+d+".length==="+e,"invalid vector, should have length "+e)}function i(e){t("typeof "+d+'==="function"&&'+d+'._reglType==="texture'+(3553===e?"2d":"Cube")+'"',"invalid texture type")}switch(b){case ie:n("number");break;case oe:a(2);break;case fe:a(3);break;case ue:a(4);break;case te:n("number");break;case re:a(2);break;case ne:a(3);break;case ae:a(4);break;case se:n("boolean");break;case ce:a(2);break;case le:a(3);break;case pe:case de:a(4);break;case me:a(9);break;case he:a(16);break;case be:i(3553);break;case ge:i(34067)}}));var A=1;switch(b){case be:case ge:var _=r.def(d,"._texture");r(l,".uniform1i(",v,",",_,".bind());"),r.exit(_,".unbind();");continue;case ie:case se:s="1i";break;case oe:case ce:s="2i",A=2;break;case fe:case le:s="3i",A=3;break;case ue:case pe:s="4i",A=4;break;case te:s="1f";break;case re:s="2f",A=2;break;case ne:s="3f",A=3;break;case ae:s="4f",A=4;break;case de:s="Matrix2fv";break;case me:s="Matrix3fv";break;case he:s="Matrix4fv"}if(r(l,".uniform",s,"(",v,","),"M"===s.charAt(0)){var S=Math.pow(b-de+2,2),E=e.global.def("new Float32Array(",S,")");r("false,(Array.isArray(",d,")||",d," instanceof Float32Array)?",d,":(",i(S,(function(e){return E+"["+e+"]="+d+"["+e+"]"})),",",E,")")}else r(A>1?i(A,(function(e){return d+"["+e+"]"})):d);r(");")}}function ht(e,t,r,a){var i=e.shared,o=i.gl,f=i.draw,u=a.draw,s=function(){var n,i=u.elements,s=t;return i?((i.contextDep&&a.contextDynamic||i.propDep)&&(s=r),n=i.append(e,s)):n=s.def(f,".",U),n&&s("if("+n+")"+o+".bindBuffer(34963,"+n+".buffer.buffer);"),n}();function c(n){var i=u[n];return i?i.contextDep&&a.contextDynamic||i.propDep?i.append(e,r):i.append(e,t):t.def(f,".",n)}var l,p,d=c(G),m=c(V),h=function(){var i,o=u.count,s=t;return o?((o.contextDep&&a.contextDynamic||o.propDep)&&(s=r),i=o.append(e,s),n.optional((function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(s,i+">=0","missing vertex count")}))):(i=s.def(f,".",Q),n.optional((function(){e.assert(s,i+">=0","missing vertex count")}))),i}();if("number"==typeof h){if(0===h)return}else r("if(",h,"){"),r.exit("}");Qe&&(l=c(Y),p=e.instancing);var b=s+".type",g=u.elements&&Oe(u.elements);function v(){function e(){r(p,".drawElementsInstancedANGLE(",[d,h,b,m+"<<(("+b+"-5121)>>1)",l],");")}function t(){r(p,".drawArraysInstancedANGLE(",[d,m,h,l],");")}s?g?e():(r("if(",s,"){"),e(),r("}else{"),t(),r("}")):t()}function y(){function e(){r(o+".drawElements("+[d,h,b,m+"<<(("+b+"-5121)>>1)"]+");")}function t(){r(o+".drawArrays("+[d,m,h]+");")}s?g?e():(r("if(",s,"){"),e(),r("}else{"),t(),r("}")):t()}Qe&&("number"!=typeof l||l>=0)?"string"==typeof l?(r("if(",l,">0){"),v(),r("}else if(",l,"<0){"),y(),r("}")):v():y()}function bt(e,t,r,a,i){var o=it(),f=o.proc("body",i);return n.optional((function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)})),Qe&&(o.instancing=f.def(o.shared.extensions,".angle_instanced_arrays")),e(o,f,r,a),o.compile().body}function gt(e,t,r,n){lt(e,t),dt(e,t,r,n.attributes,(function(){return!0})),mt(e,t,r,n.uniforms,(function(){return!0})),ht(e,t,t,r)}function vt(e,t,r,n){function a(){return!0}e.batchId="a1",lt(e,t),dt(e,t,r,n.attributes,a),mt(e,t,r,n.uniforms,a),ht(e,t,t,r)}function yt(e,t,r,n){lt(e,t);var a=r.contextDep,i=t.def(),o=t.def();e.shared.props=o,e.batchId=i;var f=e.scope(),u=e.scope();function s(e){return e.contextDep&&a||e.propDep}function c(e){return!s(e)}if(t(f.entry,"for(",i,"=0;",i,"<","a1",";++",i,"){",o,"=","a0","[",i,"];",u,"}",f.exit),r.needsContext&&ft(e,u,r.context),r.needsFramebuffer&&ut(e,u,r.framebuffer),ct(e,u,r.state,s),r.profile&&s(r.profile)&&pt(e,u,r,!1,!0),n)dt(e,f,r,n.attributes,c),dt(e,u,r,n.attributes,s),mt(e,f,r,n.uniforms,c),mt(e,u,r,n.uniforms,s),ht(e,f,u,r);else{var l=e.global.def("{}"),p=r.shader.progVar.append(e,u),d=u.def(p,".id"),m=u.def(l,"[",d,"]");u(e.shared.gl,".useProgram(",p,".program);","if(!",m,"){",m,"=",l,"[",d,"]=",e.link((function(t){return bt(vt,e,r,t,2)})),"(",p,");}",m,".call(this,a0[",i,"],",i,");")}}function xt(e,t,r){var n=t.static[r];if(n&&function(e){if("object"==typeof e&&!u(e)){for(var t=Object.keys(e),r=0;r<t.length;++r)if(s.isDynamic(e[t[r]]))return!0;return!1}}(n)){var a=e.global,i=Object.keys(n),o=!1,f=!1,c=!1,l=e.global.def("{}");i.forEach((function(t){var r=n[t];if(s.isDynamic(r)){"function"==typeof r&&(r=n[t]=s.unbox(r));var i=Me(r,null);o=o||i.thisDep,c=c||i.propDep,f=f||i.contextDep}else{switch(a(l,".",t,"="),typeof r){case"number":a(r);break;case"string":a('"',r,'"');break;case"object":Array.isArray(r)&&a("[",r.join(),"]");break;default:a(e.link(r))}a(";")}})),t.dynamic[r]=new s.DynamicVariable(4,{thisDep:o,contextDep:f,propDep:c,ref:l,append:function(e,t){i.forEach((function(r){var a=n[r];if(s.isDynamic(a)){var i=e.invoke(t,a);t(l,".",r,"=",i,";")}}))}}),delete t.static[r]}}return{next:$e,current:Ye,procs:function(){var t=it(),r=t.proc("poll"),n=t.proc("refresh"),a=t.block();r(a),n(a);var f=t.shared,s=f.gl,c=f.next,l=f.current;a(l,".dirty=false;"),ut(t,r),ut(t,n,null,!0);var p,d=e.getExtension("angle_instanced_arrays");d&&(p=t.link(d));for(var m=0;m<o.maxAttributes;++m){var h=n.def(f.attributes,"[",m,"]"),b=t.cond(h,".buffer");b.then(s,".enableVertexAttribArray(",m,");",s,".bindBuffer(",ee,",",h,".buffer.buffer);",s,".vertexAttribPointer(",m,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);").else(s,".disableVertexAttribArray(",m,");",s,".vertexAttrib4f(",m,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;"),n(b),d&&n(p,".vertexAttribDivisorANGLE(",m,",",h,".divisor);")}return Object.keys(Xe).forEach((function(e){var i=Xe[e],o=a.def(c,".",e),f=t.block();f("if(",o,"){",s,".enable(",i,")}else{",s,".disable(",i,")}",l,".",e,"=",o,";"),n(f),r("if(",o,"!==",l,".",e,"){",f,"}")})),Object.keys(Ke).forEach((function(e){var o,f,p=Ke[e],d=Ye[e],m=t.block();if(m(s,".",p,"("),u(d)){var h=d.length;o=t.global.def(c,".",e),f=t.global.def(l,".",e),m(i(h,(function(e){return o+"["+e+"]"})),");",i(h,(function(e){return f+"["+e+"]="+o+"["+e+"];"})).join("")),r("if(",i(h,(function(e){return o+"["+e+"]!=="+f+"["+e+"]"})).join("||"),"){",m,"}")}else o=a.def(c,".",e),f=a.def(l,".",e),m(o,");",l,".",e,"=",o,";"),r("if(",o,"!==",f,"){",m,"}");n(m)})),t.compile()}(),compile:function(e,r,n,a,i){var o=it();o.stats=o.link(i),Object.keys(r.static).forEach((function(e){xt(o,r,e)})),Z.forEach((function(t){xt(o,e,t)}));var f=ot(e,r,n,a);return function(e,t){var r=e.proc("draw",1);lt(e,r),ft(e,r,t.context),ut(e,r,t.framebuffer),st(e,r,t),ct(e,r,t.state),pt(e,r,t,!1,!0);var n=t.shader.progVar.append(e,r);if(r(e.shared.gl,".useProgram(",n,".program);"),t.shader.program)gt(e,r,t,t.shader.program);else{var a=e.global.def("{}"),i=r.def(n,".id"),o=r.def(a,"[",i,"]");r(e.cond(o).then(o,".call(this,a0);").else(o,"=",a,"[",i,"]=",e.link((function(r){return bt(gt,e,t,r,1)})),"(",n,");",o,".call(this,a0);"))}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}(o,f),function(e,r){var n=e.proc("scope",3);e.batchId="a2";var a=e.shared,i=a.current;function o(t){var i=r.shader[t];i&&n.set(a.shader,"."+t,i.append(e,n))}ft(e,n,r.context),r.framebuffer&&r.framebuffer.append(e,n),Te(Object.keys(r.state)).forEach((function(t){var i=r.state[t].append(e,n);u(i)?i.forEach((function(r,a){n.set(e.next[t],"["+a+"]",r)})):n.set(a.next,"."+t,i)})),pt(e,n,r,!0,!0),[U,V,Q,Y,G].forEach((function(t){var i=r.draw[t];i&&n.set(a.draw,"."+t,""+i.append(e,n))})),Object.keys(r.uniforms).forEach((function(i){n.set(a.uniforms,"["+t.id(i)+"]",r.uniforms[i].append(e,n))})),Object.keys(r.attributes).forEach((function(t){var a=r.attributes[t].append(e,n),i=e.scopeAttrib(t);Object.keys(new Ue).forEach((function(e){n.set(i,"."+e,a[e])}))})),o(q),o(H),Object.keys(r.state).length>0&&(n(i,".dirty=true;"),n.exit(i,".dirty=true;")),n("a1(",e.shared.context,",a0,",e.batchId,");")}(o,f),function(e,t){var r=e.proc("batch",2);e.batchId="0",lt(e,r);var n=!1,a=!0;Object.keys(t.context).forEach((function(e){n=n||t.context[e].propDep})),n||(ft(e,r,t.context),a=!1);var i=t.framebuffer,o=!1;function f(e){return e.contextDep&&n||e.propDep}i?(i.propDep?n=o=!0:i.contextDep&&n&&(o=!0),o||ut(e,r,i)):ut(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(n=!0),st(e,r,t),ct(e,r,t.state,(function(e){return!f(e)})),t.profile&&f(t.profile)||pt(e,r,t,!1,"a1"),t.contextDep=n,t.needsContext=a,t.needsFramebuffer=o;var u=t.shader.progVar;if(u.contextDep&&n||u.propDep)yt(e,r,t,null);else{var s=u.append(e,r);if(r(e.shared.gl,".useProgram(",s,".program);"),t.shader.program)yt(e,r,t,t.shader.program);else{var c=e.global.def("{}"),l=r.def(s,".id"),p=r.def(c,"[",l,"]");r(e.cond(p).then(p,".call(this,a0,a1);").else(p,"=",c,"[",l,"]=",e.link((function(r){return bt(yt,e,t,r,2)})),"(",s,");",p,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}(o,f),o.compile()}}}},414:e=>{var t=0;function r(e,r){this.id=t++,this.type=e,this.data=r}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function a(e){if(0===e.length)return[];var t=e.charAt(0),r=e.charAt(e.length-1);if(e.length>1&&t===r&&('"'===t||"'"===t))return['"'+n(e.substr(1,e.length-2))+'"'];var i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(i)return a(e.substr(0,i.index)).concat(a(i[1])).concat(a(e.substr(i.index+i[0].length)));var o=e.split(".");if(1===o.length)return['"'+n(e)+'"'];for(var f=[],u=0;u<o.length;++u)f=f.concat(a(o[u]));return f}function i(e){return"["+a(e).join("][")+"]"}e.exports={DynamicVariable:r,define:function(e,t){return new r(e,i(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof r},unbox:function(e,t){return"function"==typeof e?new r(0,e):e},accessor:i}},80:(e,t,r)=>{var n=r(343),a=r(809),i=r(533),o=r(326),f=r(220),u=r(925),s=5121,c=5123,l=5125,p=34963;e.exports=function(e,t,r,d){var m={},h=0,b={uint8:s,uint16:c};function g(e){this.id=h++,m[this.id]=this,this.buffer=e,this.primType=4,this.vertCount=0,this.type=0}t.oes_element_index_uint&&(b.uint32=l),g.prototype.bind=function(){this.buffer.bind()};var v=[];function y(e,o,f,u,p,d,m){var h=m;m||a(o)&&(!i(o)||a(o.data))||(h=t.oes_element_index_uint?l:c),e.buffer.bind(),r._initBuffer(e.buffer,o,f,h,3);var b=m;if(!m){switch(e.buffer.dtype){case s:case 5120:b=s;break;case c:case 5122:b=c;break;case l:case 5124:b=l;break;default:n.raise("unsupported type for element array")}e.buffer.dtype=b}e.type=b,n(b!==l||!!t.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var g=p;g<0&&(g=e.buffer.byteLength,b===c?g>>=1:b===l&&(g>>=2)),e.vertCount=g;var v=u;if(u<0){v=4;var y=e.buffer.dimension;1===y&&(v=0),2===y&&(v=1),3===y&&(v=4)}e.primType=v}function x(e){d.elementsCount--,n(null!==e.buffer,"must not double destroy elements"),delete m[e.id],e.buffer.destroy(),e.buffer=null}return{create:function(t){var o=r.create(null,p,!0),c=new g(o._buffer);function l(t){if(t)if("number"==typeof t)o(t),c.primType=4,c.vertCount=0|t,c.type=s;else{var r=null,d=35044,m=-1,h=-1,g=0,v=0;if(Array.isArray(t)||a(t)||i(t)?r=t:(n.type(t,"object","invalid arguments for elements"),"data"in t&&(r=t.data,n(Array.isArray(r)||a(r)||i(r),"invalid data for element buffer")),"usage"in t&&(n.parameter(t.usage,u,"invalid element buffer usage"),d=u[t.usage]),"primitive"in t&&(n.parameter(t.primitive,f,"invalid element buffer primitive"),m=f[t.primitive]),"count"in t&&(n("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),h=0|t.count),"length"in t&&(g=0|t.length),"type"in t&&(n.parameter(t.type,b,"invalid buffer type"),v=b[t.type])),r)y(c,r,d,m,h,0,v);else{var x=c.buffer;x.bind(),e.bufferData(p,g,d),x.dtype=v||s,x.usage=d,x.dimension=3,x.byteLength=g,c.primType=m<0?4:m,c.vertCount=h<0?0:h,c.type=x.dtype}}else o(),c.primType=4,c.vertCount=0,c.type=s;return l}return d.elementsCount++,l(t),l._reglType="elements",l._elements=c,l.subdata=function(e,t){return o.subdata(e,t),l},l.destroy=function(){x(c)},l},createStream:function(e){var t=v.pop();return t||(t=new g(r.create(null,p,!0)._buffer)),y(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){v.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof g?e._elements:null},clear:function(){o(m).forEach(x)}}}},75:(e,t,r)=>{var n=r(343);e.exports=function(e,t){var r={};function a(t){n.type(t,"string","extension name must be string");var a,i=t.toLowerCase();try{a=r[i]=e.getExtension(i)}catch(e){}return!!a}for(var i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!a(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(a),{extensions:r}}},498:(e,t,r)=>{var n=r(343),a=r(326),i=r(207),o=36160,f=36161,u=3553,s=34069,c=[6408],l=[];l[6408]=4;var p=[];p[5121]=1,p[5126]=4,p[36193]=2;var d=[32854,32855,36194,35907,34842,34843,34836],m={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"};e.exports=function(e,t,r,h,b,g){var v={cur:null,next:null,dirty:!1},y=["rgba"],x=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&x.push("srgba"),t.ext_color_buffer_half_float&&x.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&x.push("rgba32f");var w=["uint8"];function k(e,t,r){this.target=e,this.texture=t,this.renderbuffer=r;var n=0,a=0;t?(n=t.width,a=t.height):r&&(n=r.width,a=r.height),this.width=n,this.height=a}function A(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function _(e,t,r){if(e)if(e.texture){var a=e.texture._texture,i=Math.max(1,a.width),o=Math.max(1,a.height);n(i===t&&o===r,"inconsistent width/height for supplied texture"),a.refCount+=1}else{var f=e.renderbuffer._renderbuffer;n(f.width===t&&f.height===r,"inconsistent width/height for renderbuffer"),f.refCount+=1}}function S(t,r){r?r.texture?e.framebufferTexture2D(o,t,r.target,r.texture._texture.texture,0):e.framebufferRenderbuffer(o,t,f,r.renderbuffer._renderbuffer.renderbuffer):e.framebufferTexture2D(o,t,u,null,0)}function E(e){var t=u,r=null,a=null,i=e;"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),n.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(r=i,n(t===u)):"textureCube"===o?(r=i,n(t>=s&&t<34075,"invalid cube map target")):"renderbuffer"===o?(a=i,t=f):n.raise("invalid regl object for attachment"),new k(t,r,a)}function j(e,t,r,n,a){if(r){var i=h.create2D({width:e,height:t,format:n,type:a});return i._texture.refCount=0,new k(u,i,null)}var o=b.create({width:e,height:t,format:n});return o._renderbuffer.refCount=0,new k(f,null,o)}function T(e){return e&&(e.texture||e.renderbuffer)}function D(e,t,r){e&&(e.texture?e.texture.resize(t,r):e.renderbuffer&&e.renderbuffer.resize(t,r))}t.oes_texture_half_float&&w.push("half float","float16"),t.oes_texture_float&&w.push("float","float32");var O=0,C={};function M(){this.id=O++,C[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function z(e){e.colorAttachments.forEach(A),A(e.depthAttachment),A(e.stencilAttachment),A(e.depthStencilAttachment)}function F(t){var r=t.framebuffer;n(r,"must not double destroy framebuffer"),e.deleteFramebuffer(r),t.framebuffer=null,g.framebufferCount--,delete C[t.id]}function P(t){var a;e.bindFramebuffer(o,t.framebuffer);var i=t.colorAttachments;for(a=0;a<i.length;++a)S(36064+a,i[a]);for(a=i.length;a<r.maxColorAttachments;++a)S(36064+a,null);S(36096,t.depthAttachment),S(36128,t.stencilAttachment),S(33306,t.depthStencilAttachment);var f=e.checkFramebufferStatus(o);36053!==f&&n.raise("framebuffer configuration not supported, status = "+m[f]),e.bindFramebuffer(o,v.next),v.cur=v.next,e.getError()}function B(e,a){var o=new M;function f(e,a){var i;n(v.next!==o,"can not update framebuffer which is currently in use");var u=t.webgl_draw_buffers,s=0,m=0,h=!0,b=!0,g=null,k=!0,A="rgba",S="uint8",D=1,O=null,C=null,M=null,F=!1;if("number"==typeof e)s=0|e,m=0|a||s;else if(e){n.type(e,"object","invalid arguments for framebuffer");var B=e;if("shape"in B){var L=B.shape;n(Array.isArray(L)&&L.length>=2,"invalid shape for framebuffer"),s=L[0],m=L[1]}else"radius"in B&&(s=m=B.radius),"width"in B&&(s=B.width),"height"in B&&(m=B.height);("color"in B||"colors"in B)&&(g=B.color||B.colors,Array.isArray(g)&&n(1===g.length||u,"multiple render targets not supported")),g||("colorCount"in B&&(D=0|B.colorCount,n(D>0,"invalid color buffer count")),"colorTexture"in B&&(k=!!B.colorTexture,A="rgba4"),"colorType"in B&&(S=B.colorType,k?(n(t.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),n(t.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(n(t.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),A="rgba16f"):"float"!==S&&"float32"!==S||(n(t.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),A="rgba32f"),n.oneOf(S,w,"invalid color type")),"colorFormat"in B&&(A=B.colorFormat,y.indexOf(A)>=0?k=!0:x.indexOf(A)>=0?k=!1:k?n.oneOf(B.colorFormat,y,"invalid color format for texture"):n.oneOf(B.colorFormat,x,"invalid color format for renderbuffer"))),("depthTexture"in B||"depthStencilTexture"in B)&&(F=!(!B.depthTexture&&!B.depthStencilTexture),n(!F||t.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in B&&("boolean"==typeof B.depth?h=B.depth:(O=B.depth,b=!1)),"stencil"in B&&("boolean"==typeof B.stencil?b=B.stencil:(C=B.stencil,h=!1)),"depthStencil"in B&&("boolean"==typeof B.depthStencil?h=b=B.depthStencil:(M=B.depthStencil,h=!1,b=!1))}else s=m=1;var I=null,R=null,W=null,N=null;if(Array.isArray(g))I=g.map(E);else if(g)I=[E(g)];else for(I=new Array(D),i=0;i<D;++i)I[i]=j(s,m,k,A,S);n(t.webgl_draw_buffers||I.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),n(I.length<=r.maxColorAttachments,"too many color attachments, not supported"),s=s||I[0].width,m=m||I[0].height,O?R=E(O):h&&!b&&(R=j(s,m,F,"depth","uint32")),C?W=E(C):b&&!h&&(W=j(s,m,!1,"stencil","uint8")),M?N=E(M):!O&&!C&&b&&h&&(N=j(s,m,F,"depth stencil","depth stencil")),n(!!O+!!C+!!M<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var q=null;for(i=0;i<I.length;++i)if(_(I[i],s,m),n(!I[i]||I[i].texture&&c.indexOf(I[i].texture._texture.format)>=0||I[i].renderbuffer&&d.indexOf(I[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),I[i]&&I[i].texture){var H=l[I[i].texture._texture.format]*p[I[i].texture._texture.type];null===q?q=H:n(q===H,"all color attachments much have the same number of bits per pixel.")}return _(R,s,m),n(!R||R.texture&&6402===R.texture._texture.format||R.renderbuffer&&33189===R.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),_(W,s,m),n(!W||W.renderbuffer&&36168===W.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),_(N,s,m),n(!N||N.texture&&34041===N.texture._texture.format||N.renderbuffer&&34041===N.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),z(o),o.width=s,o.height=m,o.colorAttachments=I,o.depthAttachment=R,o.stencilAttachment=W,o.depthStencilAttachment=N,f.color=I.map(T),f.depth=T(R),f.stencil=T(W),f.depthStencil=T(N),f.width=o.width,f.height=o.height,P(o),f}return g.framebufferCount++,f(e,a),i(f,{resize:function(e,t){n(v.next!==o,"can not resize a framebuffer which is currently in use");var r=0|e,a=0|t||r;if(r===o.width&&a===o.height)return f;for(var i=o.colorAttachments,u=0;u<i.length;++u)D(i[u],r,a);return D(o.depthAttachment,r,a),D(o.stencilAttachment,r,a),D(o.depthStencilAttachment,r,a),o.width=f.width=r,o.height=f.height=a,P(o),f},_reglType:"framebuffer",_framebuffer:o,destroy:function(){F(o),z(o)}})}return i(v,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof M)return t}return null},create:B,createCube:function(e){var a=Array(6);function o(e){var r;n(a.indexOf(v.next)<0,"can not update framebuffer which is currently in use");var f,u=t.webgl_draw_buffers,c={color:null},l=0,p=null,d="rgba",m="uint8",b=1;if("number"==typeof e)l=0|e;else if(e){n.type(e,"object","invalid arguments for framebuffer");var g=e;if("shape"in g){var x=g.shape;n(Array.isArray(x)&&x.length>=2,"invalid shape for framebuffer"),n(x[0]===x[1],"cube framebuffer must be square"),l=x[0]}else"radius"in g&&(l=0|g.radius),"width"in g?(l=0|g.width,"height"in g&&n(g.height===l,"must be square")):"height"in g&&(l=0|g.height);("color"in g||"colors"in g)&&(p=g.color||g.colors,Array.isArray(p)&&n(1===p.length||u,"multiple render targets not supported")),p||("colorCount"in g&&(b=0|g.colorCount,n(b>0,"invalid color buffer count")),"colorType"in g&&(n.oneOf(g.colorType,w,"invalid color type"),m=g.colorType),"colorFormat"in g&&(d=g.colorFormat,n.oneOf(g.colorFormat,y,"invalid color format for texture"))),"depth"in g&&(c.depth=g.depth),"stencil"in g&&(c.stencil=g.stencil),"depthStencil"in g&&(c.depthStencil=g.depthStencil)}else l=1;if(p)if(Array.isArray(p))for(f=[],r=0;r<p.length;++r)f[r]=p[r];else f=[p];else{f=Array(b);var k={radius:l,format:d,type:m};for(r=0;r<b;++r)f[r]=h.createCube(k)}for(c.color=Array(f.length),r=0;r<f.length;++r){var A=f[r];n("function"==typeof A&&"textureCube"===A._reglType,"invalid cube map"),l=l||A.width,n(A.width===l&&A.height===l,"invalid cube map shape"),c.color[r]={target:s,data:f[r]}}for(r=0;r<6;++r){for(var _=0;_<f.length;++_)c.color[_].target=s+r;r>0&&(c.depth=a[0].depth,c.stencil=a[0].stencil,c.depthStencil=a[0].depthStencil),a[r]?a[r](c):a[r]=B(c)}return i(o,{width:l,height:l,color:f})}return o(e),i(o,{faces:a,resize:function(e){var t,i=0|e;if(n(i>0&&i<=r.maxCubeMapSize,"invalid radius for cube fbo"),i===o.width)return o;var f=o.color;for(t=0;t<f.length;++t)f[t].resize(i);for(t=0;t<6;++t)a[t].resize(i);return o.width=o.height=i,o},_reglType:"framebufferCube",destroy:function(){a.forEach((function(e){e.destroy()}))}})},clear:function(){a(C).forEach(F)}})}},12:e=>{e.exports=function(e,t){var r=1;t.ext_texture_filter_anisotropic&&(r=e.getParameter(34047));var n=1,a=1;return t.webgl_draw_buffers&&(n=e.getParameter(34852),a=e.getParameter(36063)),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:a,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}}},229:(e,t,r)=>{var n=r(343),a=r(809),i=5121,o=5126;e.exports=function(e,t,r,f,u,s){return function(c){var l;null===t.next?(n(u.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),l=i):(n(null!==t.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),l=t.next.colorAttachments[0].texture._texture.type,s.oes_texture_float?n(l===i||l===o,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):n(l===i,"Reading from a framebuffer is only allowed for the type 'uint8'"));var p=0,d=0,m=f.framebufferWidth,h=f.framebufferHeight,b=null;a(c)?b=c:c&&(n.type(c,"object","invalid arguments to regl.read()"),p=0|c.x,d=0|c.y,n(p>=0&&p<f.framebufferWidth,"invalid x offset for regl.read"),n(d>=0&&d<f.framebufferHeight,"invalid y offset for regl.read"),m=0|(c.width||f.framebufferWidth-p),h=0|(c.height||f.framebufferHeight-d),b=c.data||null),b&&(l===i?n(b instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):l===o&&n(b instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),n(m>0&&m+p<=f.framebufferWidth,"invalid width for read pixels"),n(h>0&&h+d<=f.framebufferHeight,"invalid height for read pixels"),r();var g=m*h*4;return b||(l===i?b=new Uint8Array(g):l===o&&(b=b||new Float32Array(g))),n.isTypedArray(b,"data buffer for regl.read() must be a typedarray"),n(b.byteLength>=g,"data buffer for regl.read() too small"),e.pixelStorei(3333,4),e.readPixels(p,d,m,h,6408,l,b),b}}},737:(e,t,r)=>{var n=r(343),a=r(326),i=36161,o=32854,f=[];function u(e,t,r){return f[e]*t*r}f[32854]=2,f[32855]=2,f[36194]=2,f[33189]=2,f[36168]=1,f[34041]=4,f[35907]=4,f[34836]=16,f[34842]=8,f[34843]=6,e.exports=function(e,t,r,f,s){var c={rgba4:o,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(c.srgba=35907),t.ext_color_buffer_half_float&&(c.rgba16f=34842,c.rgb16f=34843),t.webgl_color_buffer_float&&(c.rgba32f=34836);var l=0,p={};function d(e){this.id=l++,this.refCount=1,this.renderbuffer=e,this.format=o,this.width=0,this.height=0,s.profile&&(this.stats={size:0})}function m(t){var r=t.renderbuffer;n(r,"must not double destroy renderbuffer"),e.bindRenderbuffer(i,null),e.deleteRenderbuffer(r),t.renderbuffer=null,t.refCount=0,delete p[t.id],f.renderbufferCount--}return d.prototype.decRef=function(){--this.refCount<=0&&m(this)},s.profile&&(f.getTotalRenderbufferSize=function(){var e=0;return Object.keys(p).forEach((function(t){e+=p[t].stats.size})),e}),{create:function(t,a){var l=new d(e.createRenderbuffer());function m(t,a){var f=0,p=0,d=o;if("object"==typeof t&&t){var h=t;if("shape"in h){var b=h.shape;n(Array.isArray(b)&&b.length>=2,"invalid renderbuffer shape"),f=0|b[0],p=0|b[1]}else"radius"in h&&(f=p=0|h.radius),"width"in h&&(f=0|h.width),"height"in h&&(p=0|h.height);"format"in h&&(n.parameter(h.format,c,"invalid renderbuffer format"),d=c[h.format])}else"number"==typeof t?(f=0|t,p="number"==typeof a?0|a:f):t?n.raise("invalid arguments to renderbuffer constructor"):f=p=1;if(n(f>0&&p>0&&f<=r.maxRenderbufferSize&&p<=r.maxRenderbufferSize,"invalid renderbuffer size"),f!==l.width||p!==l.height||d!==l.format)return m.width=l.width=f,m.height=l.height=p,l.format=d,e.bindRenderbuffer(i,l.renderbuffer),e.renderbufferStorage(i,d,f,p),s.profile&&(l.stats.size=u(l.format,l.width,l.height)),m}return p[l.id]=l,f.renderbufferCount++,m(t,a),m.resize=function(t,a){var o=0|t,f=0|a||o;return o===l.width&&f===l.height||(n(o>0&&f>0&&o<=r.maxRenderbufferSize&&f<=r.maxRenderbufferSize,"invalid renderbuffer size"),m.width=l.width=o,m.height=l.height=f,e.bindRenderbuffer(i,l.renderbuffer),e.renderbufferStorage(i,l.format,o,f),s.profile&&(l.stats.size=u(l.format,l.width,l.height))),m},m._reglType="renderbuffer",m._renderbuffer=l,s.profile&&(m.stats=l.stats),m.destroy=function(){l.decRef()},m},clear:function(){a(p).forEach(m)}}}},699:(e,t,r)=>{var n=r(343),a=r(326);e.exports=function(e,t,r,i){var o={},f={};function u(e,t,r,n){this.name=e,this.id=t,this.location=r,this.info=n}function s(e,t){for(var r=0;r<e.length;++r)if(e[r].id===t.id)return void(e[r].location=t.location);e.push(t)}function c(r,a,i){var u=35632===r?o:f,s=u[a];if(!s){var c=t.str(a);s=e.createShader(r),e.shaderSource(s,c),e.compileShader(s),n.shaderError(e,s,c,r,i),u[a]=s}return s}var l={},p=[],d=0;function m(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}return i.profile&&(r.getMaxUniformsCount=function(){var e=0;return p.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},r.getMaxAttributesCount=function(){var e=0;return p.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);a(o).forEach(t),o={},a(f).forEach(t),f={},p.forEach((function(t){e.deleteProgram(t.program)})),p.length=0,l={},r.shaderCount=0},program:function(a,o,f){n.command(a>=0,"missing vertex shader",f),n.command(o>=0,"missing fragment shader",f),r.shaderCount++;var d=l[o];d||(d=l[o]={});var h=d[a];return h||(function(r,a){var o,f,l=c(35632,r.fragId),p=c(35633,r.vertId),d=r.program=e.createProgram();e.attachShader(d,l),e.attachShader(d,p),e.linkProgram(d),n.linkError(e,d,t.str(r.fragId),t.str(r.vertId),a);var m=e.getProgramParameter(d,35718);i.profile&&(r.stats.uniformsCount=m);var h=r.uniforms;for(o=0;o<m;++o)if(f=e.getActiveUniform(d,o))if(f.size>1)for(var b=0;b<f.size;++b){var g=f.name.replace("[0]","["+b+"]");s(h,new u(g,t.id(g),e.getUniformLocation(d,g),f))}else s(h,new u(f.name,t.id(f.name),e.getUniformLocation(d,f.name),f));var v=e.getProgramParameter(d,35721);i.profile&&(r.stats.attributesCount=v);var y=r.attributes;for(o=0;o<v;++o)(f=e.getActiveAttrib(d,o))&&s(y,new u(f.name,t.id(f.name),e.getAttribLocation(d,f.name),f))}(h=new m(o,a),f),d[a]=h,p.push(h)),h},shader:c,frag:-1,vert:-1}}},827:e=>{e.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},927:e=>{e.exports=function(){var e={"":0},t=[""];return{id:function(r){var n=e[r];return n||(n=e[r]=t.length,t.push(r),n)},str:function(e){return t[e]}}}},315:(e,t,r)=>{var n=r(343),a=r(207),i=r(326),o=r(809),f=r(533),u=r(256),s=r(856),c=r(783),l=r(486),p=r(486),d=3553,m=34069,h=6408,b=6407,g=6409,v=6410,y=36193,x=5121,w=5125,k=5126,A=33071,_=9728,S=9984,E=9987,j=4352,T=33984,D=[S,9986,9985,E],O=[0,g,v,b,h],C={};C[6409]=C[6406]=C[6402]=1,C[34041]=C[6410]=2,C[6407]=C[35904]=3,C[6408]=C[35906]=4;var M={};function z(e){return"[object "+e+"]"}M[32854]=32819,M[36194]=33635,M[32855]=32820,M[6402]=w,M[34041]=34042;var F=z("HTMLCanvasElement"),P=z("CanvasRenderingContext2D"),B=z("HTMLImageElement"),L=z("HTMLVideoElement"),I=Object.keys(l).concat([F,P,B,L]),R=[];R[5121]=1,R[5126]=4,R[36193]=2,R[5123]=2,R[5125]=4;var W=[];function N(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function q(e){return!!Array.isArray(e)&&!(0===e.length||!c(e[0]))}function H(e){return Object.prototype.toString.call(e)}function U(e){return H(e)===F}function G(e){if(!e)return!1;var t=H(e);return I.indexOf(t)>=0||N(e)||q(e)||f(e)}function Q(e){return 0|p[Object.prototype.toString.call(e)]}function V(e,t){return u.allocType(e.type===y?k:e.type,t)}function Y(e,t){e.type===y?(e.data=s(t),u.freeType(t)):e.data=t}function $(e,t,r,n,a,i){var o;if(o=void 0!==W[e]?W[e]:C[e]*R[t],i&&(o*=6),a){for(var f=0,u=r;u>=1;)f+=o*u*u,u/=2;return f}return o*r*n}W[32854]=2,W[32855]=2,W[36194]=2,W[34041]=4,W[33776]=.5,W[33777]=.5,W[33778]=1,W[33779]=1,W[35986]=.5,W[35987]=1,W[34798]=1,W[35840]=.5,W[35841]=.25,W[35842]=.5,W[35843]=.25,W[36196]=.5,e.exports=function(e,t,r,l,p,M,z){var F={"don't care":j,"dont care":j,nice:4354,fast:4353},I={repeat:10497,clamp:A,mirror:33648},R={nearest:_,linear:9729},W=a({"nearest mipmap nearest":S,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":E,mipmap:E},R),J={none:0,browser:37444},X={uint8:x,rgba4:32819,rgb565:33635,"rgb5 a1":32820},K={alpha:6406,luminance:g,"luminance alpha":v,rgb:b,rgba:h,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Z={};t.ext_srgb&&(K.srgb=35904,K.srgba=35906),t.oes_texture_float&&(X.float32=X.float=k),t.oes_texture_half_float&&(X.float16=X["half float"]=y),t.webgl_depth_texture&&(a(K,{depth:6402,"depth stencil":34041}),a(X,{uint16:5123,uint32:w,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&a(Z,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&a(Z,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&a(Z,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&(Z["rgb etc1"]=36196);var ee=Array.prototype.slice.call(e.getParameter(34467));Object.keys(Z).forEach((function(e){var t=Z[e];ee.indexOf(t)>=0&&(K[e]=t)}));var te=Object.keys(K);r.textureFormats=te;var re=te.reduce((function(e,t){var r=K[t];return r===g||6406===r||r===g||r===v||6402===r||34041===r?e[r]=r:32855===r||t.indexOf("rgba")>=0?e[r]=h:e[r]=b,e}),{});function ne(){this.internalformat=h,this.format=h,this.type=x,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=0,this.width=0,this.height=0,this.channels=4}function ae(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function ie(e,a){if("object"==typeof a&&a){if("premultiplyAlpha"in a&&(n.type(a.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=a.premultiplyAlpha),"flipY"in a&&(n.type(a.flipY,"boolean","invalid texture flip"),e.flipY=a.flipY),"alignment"in a&&(n.oneOf(a.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=a.alignment),"colorSpace"in a&&(n.parameter(a.colorSpace,J,"invalid colorSpace"),e.colorSpace=J[a.colorSpace]),"type"in a){var i=a.type;n(t.oes_texture_float||!("float"===i||"float32"===i),"you must enable the OES_texture_float extension in order to use floating point textures."),n(t.oes_texture_half_float||!("half float"===i||"float16"===i),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),n(t.webgl_depth_texture||!("depth"===i||"depth stencil"===i),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),n.parameter(i,X,"invalid texture type"),e.type=X[i]}var o=e.width,f=e.height,u=e.channels,s=!1;"shape"in a?(n(Array.isArray(a.shape)&&a.shape.length>=2,"shape must be an array"),o=a.shape[0],f=a.shape[1],3===a.shape.length&&(u=a.shape[2],n(u>0&&u<=4,"invalid number of channels"),s=!0),n(o>=0&&o<=r.maxTextureSize,"invalid width"),n(f>=0&&f<=r.maxTextureSize,"invalid height")):("radius"in a&&(o=f=a.radius,n(o>=0&&o<=r.maxTextureSize,"invalid radius")),"width"in a&&(o=a.width,n(o>=0&&o<=r.maxTextureSize,"invalid width")),"height"in a&&(f=a.height,n(f>=0&&f<=r.maxTextureSize,"invalid height")),"channels"in a&&(u=a.channels,n(u>0&&u<=4,"invalid number of channels"),s=!0)),e.width=0|o,e.height=0|f,e.channels=0|u;var c=!1;if("format"in a){var l=a.format;n(t.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),n.parameter(l,K,"invalid texture format");var p=e.internalformat=K[l];e.format=re[p],l in X&&("type"in a||(e.type=X[l])),l in Z&&(e.compressed=!0),c=!0}!s&&c?e.channels=C[e.format]:s&&!c?e.channels!==O[e.format]&&(e.format=e.internalformat=O[e.channels]):c&&s&&n(e.channels===C[e.format],"number of channels inconsistent with specified format")}}function oe(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function fe(){ne.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ue(e,t){var a=null;if(G(t)?a=t:t&&(n.type(t,"object","invalid pixel data type"),ie(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),G(t.data)&&(a=t.data)),n(!e.compressed||a instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),t.copy){n(!a,"can not specify copy and data field for the same texture");var i=p.viewportWidth,l=p.viewportHeight;e.width=e.width||i-e.xOffset,e.height=e.height||l-e.yOffset,e.needsCopy=!0,n(e.xOffset>=0&&e.xOffset<i&&e.yOffset>=0&&e.yOffset<l&&e.width>0&&e.width<=i&&e.height>0&&e.height<=l,"copy texture read out of bounds")}else if(a){if(o(a))e.data=a,"type"in t||e.type!==x||(e.type=Q(a));else if(N(a))!function(e,t){var r=e.width*e.height*e.channels;switch(n(t.length===r,"inconsistent array length for texture"),e.type){case x:case 5123:case w:case k:var a=u.allocType(e.type,r);a.set(t),e.data=a;break;case y:e.data=s(t);break;default:n.raise("unsupported texture type, must specify a typed array")}}(e,a),e.alignment=1,e.needsFree=!0;else if(f(a)){var d=a.data;Array.isArray(d)||e.type!==x||(e.type=Q(d));var m,h,b,g,v,A,_=a.shape,S=a.stride;3===_.length?(b=_[2],A=S[2]):(n(2===_.length,"invalid ndarray pixel data, must be 2 or 3D"),b=1,A=1),m=_[0],h=_[1],g=S[0],v=S[1],e.alignment=1,e.width=m,e.height=h,e.channels=b,e.format=e.internalformat=O[b],e.needsFree=!0,function(e,t,r,n,a,i){for(var o=e.width,f=e.height,u=e.channels,s=V(e,o*f*u),c=0,l=0;l<f;++l)for(var p=0;p<o;++p)for(var d=0;d<u;++d)s[c++]=t[r*p+n*l+a*d+i];Y(e,s)}(e,d,g,v,A,a.offset)}else if(U(a)||H(a)===P)U(a)?e.element=a:e.element=a.canvas,e.width=e.element.width,e.height=e.element.height;else if(H(a)===B)e.element=a,e.width=a.naturalWidth,e.height=a.naturalHeight;else if(function(e){return H(e)===L}(a))e.element=a,e.width=a.videoWidth,e.height=a.videoHeight,e.needsPoll=!0;else if(q(a)){var E=a[0].length,j=a.length,T=1;c(a[0][0])?function(e,t,r,n,a){for(var i=V(e,r*n*a),o=0,f=0;f<n;++f)for(var u=t[f],s=0;s<r;++s)for(var c=u[s],l=0;l<a;++l)i[o++]=c[l];Y(e,i)}(e,a,E,j,T=a[0][0].length):function(e,t,r,n){for(var a=V(e,r*n),i=0,o=0;o<n;++o)for(var f=t[o],u=0;u<r;++u)a[i++]=f[u];Y(e,a)}(e,a,E,j),e.alignment=1,e.width=E,e.height=j,e.channels=T,e.format=e.internalformat=O[T],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1;e.type===k?n(r.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===y&&n(r.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function se(t,r,n){var a=t.element,i=t.data,o=t.internalformat,f=t.format,u=t.type,s=t.width,c=t.height;oe(t),a?e.texImage2D(r,n,f,f,u,a):t.compressed?e.compressedTexImage2D(r,n,o,s,c,0,i):t.needsCopy?(l(),e.copyTexImage2D(r,n,f,t.xOffset,t.yOffset,s,c,0)):e.texImage2D(r,n,f,s,c,0,f,u,i)}function ce(t,r,n,a,i){var o=t.element,f=t.data,u=t.internalformat,s=t.format,c=t.type,p=t.width,d=t.height;oe(t),o?e.texSubImage2D(r,i,n,a,s,c,o):t.compressed?e.compressedTexSubImage2D(r,i,n,a,u,p,d,f):t.needsCopy?(l(),e.copyTexSubImage2D(r,i,n,a,t.xOffset,t.yOffset,p,d)):e.texSubImage2D(r,i,n,a,p,d,s,c,f)}var le=[];function pe(){return le.pop()||new fe}function de(e){e.needsFree&&u.freeType(e.data),fe.call(e),le.push(e)}function me(){ne.call(this),this.genMipmaps=!1,this.mipmapHint=j,this.mipmask=0,this.images=Array(16)}function he(e,t,r){var n=e.images[0]=pe();e.mipmask=1,n.width=e.width=t,n.height=e.height=r}function be(e,t){var r=null;if(G(t))ae(r=e.images[0]=pe(),e),ue(r,t),e.mipmask=1;else if(ie(e,t),Array.isArray(t.mipmap))for(var a=t.mipmap,i=0;i<a.length;++i)ae(r=e.images[i]=pe(),e),r.width>>=i,r.height>>=i,ue(r,a[i]),e.mipmask|=1<<i;else ae(r=e.images[0]=pe(),e),ue(r,t),e.mipmask=1;ae(e,e.images[0]),(e.compressed&&33776===e.internalformat||33777===e.internalformat||33778===e.internalformat||33779===e.internalformat)&&n(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ge(e,t){for(var r=e.images,n=0;n<r.length;++n){if(!r[n])return;se(r[n],t,n)}}var ve=[];function ye(){var e=ve.pop()||new me;ne.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function xe(e){for(var t=e.images,r=0;r<t.length;++r)t[r]&&de(t[r]),t[r]=null;ve.push(e)}function we(){this.minFilter=_,this.magFilter=_,this.wrapS=A,this.wrapT=A,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=j}function ke(e,t){if("min"in t){var a=t.min;n.parameter(a,W),e.minFilter=W[a],D.indexOf(e.minFilter)>=0&&(e.genMipmaps=!0)}if("mag"in t){var i=t.mag;n.parameter(i,R),e.magFilter=R[i]}var o=e.wrapS,f=e.wrapT;if("wrap"in t){var u=t.wrap;"string"==typeof u?(n.parameter(u,I),o=f=I[u]):Array.isArray(u)&&(n.parameter(u[0],I),n.parameter(u[1],I),o=I[u[0]],f=I[u[1]])}else{if("wrapS"in t){var s=t.wrapS;n.parameter(s,I),o=I[s]}if("wrapT"in t){var c=t.wrapT;n.parameter(c,I),f=I[c]}}if(e.wrapS=o,e.wrapT=f,"anisotropic"in t){var l=t.anisotropic;n("number"==typeof l&&l>=1&&l<=r.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var p=!1;switch(typeof t.mipmap){case"string":n.parameter(t.mipmap,F,"invalid mipmap hint"),e.mipmapHint=F[t.mipmap],e.genMipmaps=!0,p=!0;break;case"boolean":p=e.genMipmaps=t.mipmap;break;case"object":n(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,p=!0;break;default:n.raise("invalid mipmap type")}p&&!("min"in t)&&(e.minFilter=S)}}function Ae(r,n){e.texParameteri(n,10241,r.minFilter),e.texParameteri(n,10240,r.magFilter),e.texParameteri(n,10242,r.wrapS),e.texParameteri(n,10243,r.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(n,34046,r.anisotropic),r.genMipmaps&&(e.hint(33170,r.mipmapHint),e.generateMipmap(n))}var _e=[];function Se(){var e=_e.pop()||new we;return we.call(e),e}function Ee(e){_e.push(e)}var je=0,Te={},De=r.maxTextureUnits,Oe=Array(De).map((function(){return null}));function Ce(t){ne.call(this),this.mipmask=0,this.internalformat=h,this.id=je++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,z.profile&&(this.stats={size:0})}function Me(t){e.activeTexture(T),e.bindTexture(t.target,t.texture)}function ze(){var t=Oe[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(d,null)}function Fe(t){var r=t.texture;n(r,"must not double destroy texture");var a=t.unit,i=t.target;a>=0&&(e.activeTexture(T+a),e.bindTexture(i,null),Oe[a]=null),e.deleteTexture(r),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete Te[t.id],M.textureCount--}return a(Ce.prototype,{bind:function(){var t=this;t.bindCount+=1;var r=t.unit;if(r<0){for(var a=0;a<De;++a){var i=Oe[a];if(i){if(i.bindCount>0)continue;i.unit=-1}Oe[a]=t,r=a;break}r>=De&&n.raise("insufficient number of texture units"),z.profile&&M.maxTextureUnits<r+1&&(M.maxTextureUnits=r+1),t.unit=r,e.activeTexture(T+r),e.bindTexture(t.target,t.texture)}return r},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Fe(this)}}),z.profile&&(M.getTotalTextureSize=function(){var e=0;return Object.keys(Te).forEach((function(t){e+=Te[t].stats.size})),e}),{create2D:function(t,a){var i=new Ce(d);function o(e,t){var a=Se(),f=ye();return"number"==typeof e?he(f,0|e,"number"==typeof t?0|t:0|e):e?(n.type(e,"object","invalid arguments to regl.texture"),ke(a,e),be(f,e)):he(f,1,1),a.genMipmaps&&(f.mipmask=(f.width<<1)-1),i.mipmask=f.mipmask,ae(i,f),n.texture2D(a,f,r),i.internalformat=f.internalformat,o.width=f.width,o.height=f.height,Me(i),ge(f,d),Ae(a,d),ze(),Ee(a),xe(f),z.profile&&(i.stats.size=$(i.internalformat,i.type,f.width,f.height,a.genMipmaps,!1)),o}return Te[i.id]=i,M.textureCount++,o(t,a),o.subimage=function(e,t,r,a){n(!!e,"must specify image data");var f=0|t,u=0|r,s=0|a,c=pe();return ae(c,i),c.width>>=s,c.height>>=s,c.width-=f,c.height-=u,ue(c,e),n(i.type===c.type&&i.format===c.format&&i.internalformat===c.internalformat,"incompatible format for texture.subimage"),n(f>=0&&u>=0&&f+c.width<=i.width&&u+c.height<=i.height,"texture.subimage write out of bounds"),n(i.mipmask&1<<s,"missing mipmap data"),n(c.data||c.element||c.needsCopy,"missing image data"),Me(i),ce(c,d,f,u,s),ze(),de(c),o},o.resize=function(t,r){var n=0|t,a=0|r||n;if(n===i.width&&a===i.height)return o;o.width=i.width=n,o.height=i.height=a,Me(i);for(var f=0;i.mipmask>>f;++f)e.texImage2D(d,f,i.format,n>>f,a>>f,0,i.format,i.type,null);return ze(),z.profile&&(i.stats.size=$(i.internalformat,i.type,n,a,!1,!1)),o},o._reglType="texture2d",o._texture=i,z.profile&&(o.stats=i.stats),o.destroy=function(){i.decRef()},o},createCube:function(t,a,i,o,f,u){var s=new Ce(34067);Te[s.id]=s,M.cubeCount++;var c=new Array(6);function l(e,t,a,i,o,f){var u,p=Se();for(u=0;u<6;++u)c[u]=ye();if("number"!=typeof e&&e)if("object"==typeof e)if(t)be(c[0],e),be(c[1],t),be(c[2],a),be(c[3],i),be(c[4],o),be(c[5],f);else if(ke(p,e),ie(s,e),"faces"in e){var d=e.faces;for(n(Array.isArray(d)&&6===d.length,"cube faces must be a length 6 array"),u=0;u<6;++u)n("object"==typeof d[u]&&!!d[u],"invalid input for cube map face"),ae(c[u],s),be(c[u],d[u])}else for(u=0;u<6;++u)be(c[u],e);else n.raise("invalid arguments to cube map");else{var h=0|e||1;for(u=0;u<6;++u)he(c[u],h,h)}for(ae(s,c[0]),p.genMipmaps?s.mipmask=(c[0].width<<1)-1:s.mipmask=c[0].mipmask,n.textureCube(s,p,c,r),s.internalformat=c[0].internalformat,l.width=c[0].width,l.height=c[0].height,Me(s),u=0;u<6;++u)ge(c[u],m+u);for(Ae(p,34067),ze(),z.profile&&(s.stats.size=$(s.internalformat,s.type,l.width,l.height,p.genMipmaps,!0)),Ee(p),u=0;u<6;++u)xe(c[u]);return l}return l(t,a,i,o,f,u),l.subimage=function(e,t,r,a,i){n(!!t,"must specify image data"),n("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|r,f=0|a,u=0|i,c=pe();return ae(c,s),c.width>>=u,c.height>>=u,c.width-=o,c.height-=f,ue(c,t),n(s.type===c.type&&s.format===c.format&&s.internalformat===c.internalformat,"incompatible format for texture.subimage"),n(o>=0&&f>=0&&o+c.width<=s.width&&f+c.height<=s.height,"texture.subimage write out of bounds"),n(s.mipmask&1<<u,"missing mipmap data"),n(c.data||c.element||c.needsCopy,"missing image data"),Me(s),ce(c,m+e,o,f,u),ze(),de(c),l},l.resize=function(t){var r=0|t;if(r!==s.width){l.width=s.width=r,l.height=s.height=r,Me(s);for(var n=0;n<6;++n)for(var a=0;s.mipmask>>a;++a)e.texImage2D(m+n,a,s.format,r>>a,r>>a,0,s.format,s.type,null);return ze(),z.profile&&(s.stats.size=$(s.internalformat,s.type,l.width,l.height,!1,!0)),l}},l._reglType="textureCube",l._texture=s,z.profile&&(l.stats=s.stats),l.destroy=function(){s.decRef()},l},clear:function(){for(var t=0;t<De;++t)e.activeTexture(T+t),e.bindTexture(d,null),Oe[t]=null;i(Te).forEach(Fe),M.cubeCount=0,M.textureCount=0},getTexture:function(e){return null}}}},249:e=>{e.exports=function(e,t){var r=t.ext_disjoint_timer_query;if(!r)return null;var n=[];function a(e){n.push(e)}var i=[];function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var f=[];function u(e){f.push(e)}var s=[];function c(e,t,r){var n=f.pop()||new o;n.startQueryIndex=e,n.endQueryIndex=t,n.sum=0,n.stats=r,s.push(n)}var l=[],p=[];return{beginQuery:function(e){var t=n.pop()||r.createQueryEXT();r.beginQueryEXT(35007,t),i.push(t),c(i.length-1,i.length,e)},endQuery:function(){r.endQueryEXT(35007)},pushScopeStats:c,update:function(){var e,t,n=i.length;if(0!==n){p.length=Math.max(p.length,n+1),l.length=Math.max(l.length,n+1),l[0]=0,p[0]=0;var o=0;for(e=0,t=0;t<i.length;++t){var f=i[t];r.getQueryObjectEXT(f,34919)?(o+=r.getQueryObjectEXT(f,34918),a(f)):i[e++]=f,l[t+1]=o,p[t+1]=e}for(i.length=e,e=0,t=0;t<s.length;++t){var c=s[t],d=c.startQueryIndex,m=c.endQueryIndex;c.sum+=l[m]-l[d];var h=p[d],b=p[m];b===h?(c.stats.gpuTime+=c.sum/1e6,u(c)):(c.startQueryIndex=h,c.endQueryIndex=b,s[e++]=c)}s.length=e}},getNumPendingQueries:function(){return i.length},clear:function(){n.push.apply(n,i);for(var e=0;e<n.length;e++)r.deleteQueryEXT(n[e]);i.length=0,n.length=0}}}},343:(e,t,r)=>{var n=r(809),a=r(207);function i(e){var t=new Error("(regl) "+e);throw console.error(t),t}function o(e,t){e||i(t)}function f(e){return e?": "+e:""}function u(e,t,r){t.indexOf(e)<0&&i("invalid value"+f(r)+". must be one of: "+t)}var s=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function c(e,t){for(e+="";e.length<t;)e=" "+e;return e}function l(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function p(e,t){this.number=e,this.line=t,this.errors=[]}function d(e,t,r){this.file=e,this.line=t,this.message=r}function m(){var e=new Error,t=(e.stack||e).toString(),r=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(r)return r[1];var n=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return n?n[1]:"unknown"}function h(){var e=new Error,t=(e.stack||e).toString(),r=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(r)return r[1];var n=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return n?n[1]:"unknown"}function b(e,t){var r,n=e.split("\n"),a=1,i=0,o={unknown:new l,0:new l};o.unknown.name=o[0].name=t||m(),o.unknown.lines.push(new p(0,""));for(var f=0;f<n.length;++f){var u=n[f],s=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(u);if(s)switch(s[1]){case"line":var c=/(\d+)(\s+\d+)?/.exec(s[2]);c&&(a=0|c[1],c[2]&&((i=0|c[2])in o||(o[i]=new l)));break;case"define":var d=/SHADER_NAME(_B64)?\s+(.*)$/.exec(s[2]);d&&(o[i].name=d[1]?(r=d[2],"undefined"!=typeof btoa?btoa(r):"base64:"+r):d[2])}o[i].lines.push(new p(a++,u))}return Object.keys(o).forEach((function(e){var t=o[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),o}function g(e){e._commandRef=m()}function v(e,t){var r=h();i(e+" in command "+(t||m())+("unknown"===r?"":" called from "+r))}var y=33071,x={};function w(e,t){return 32820===e||32819===e||33635===e?2:34042===e?4:x[e]*t}function k(e){return!(e&e-1||!e)}x[5120]=x[5121]=1,x[5122]=x[5123]=x[36193]=x[33635]=x[32819]=x[32820]=2,x[5124]=x[5125]=x[5126]=x[34042]=4,e.exports=a(o,{optional:function(e){e()},raise:i,commandRaise:v,command:function(e,t,r){e||v(t,r||m())},parameter:function(e,t,r){e in t||i("unknown parameter ("+e+")"+f(r)+". possible values: "+Object.keys(t).join())},commandParameter:function(e,t,r,n){e in t||v("unknown parameter ("+e+")"+f(r)+". possible values: "+Object.keys(t).join(),n||m())},constructor:function(e){Object.keys(e).forEach((function(e){s.indexOf(e)<0&&i('invalid regl constructor argument "'+e+'". must be one of '+s)}))},type:function(e,t,r){typeof e!==t&&i("invalid parameter type"+f(r)+". expected "+t+", got "+typeof e)},commandType:function(e,t,r,n){typeof e!==t&&v("invalid parameter type"+f(r)+". expected "+t+", got "+typeof e,n||m())},isTypedArray:function(e,t){n(e)||i("invalid parameter type"+f(t)+". must be a typed array")},nni:function(e,t){e>=0&&(0|e)===e||i("invalid parameter type, ("+e+")"+f(t)+". must be a nonnegative integer")},oneOf:u,shaderError:function(e,t,r,n,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(t),f=n===e.FRAGMENT_SHADER?"fragment":"vertex",u=b(r,a),s=function(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var r=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(e);r?t.push(new d(0|r[1],0|r[2],r[3].trim())):e.length>0&&t.push(new d("unknown",0,e))}})),t}(i);!function(e,t){t.forEach((function(t){var r=e[t.file];if(r){var n=r.index[t.line];if(n)return n.errors.push(t),void(r.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))}(u,s),Object.keys(u).forEach((function(e){var t=u[e];if(t.hasErrors){var r=[""],n=[""];a("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){a(c(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),a(e.line+"\n","color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(r){var n=r.message,i=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(n);if(i){var o=i[1];switch(n=i[2],o){case"assign":o="="}t=Math.max(e.line.indexOf(o,t),0)}else t=0;a(c("| ",6)),a(c("^^^",t+3)+"\n","font-weight:bold"),a(c("| ",6)),a(n+"\n","font-weight:bold")})),a(c("| ",6)+"\n")}else a(c(e.number,4)+"|  "),a(e.line+"\n","color:red")})),"undefined"!=typeof document?(n[0]=r.join("%c"),console.log.apply(console,n)):console.log(r.join(""))}function a(e,t){r.push(e),n.push(t||"")}})),o.raise("Error compiling "+f+" shader, "+u[0].name)}},linkError:function(e,t,r,n,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var i=e.getProgramInfoLog(t),f=b(r,a),u='Error linking program with vertex shader, "'+b(n,a)[0].name+'", and fragment shader "'+f[0].name+'"';"undefined"!=typeof document?console.log("%c"+u+"\n%c"+i,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(u+"\n"+i),o.raise(u)}},callSite:h,saveCommandRef:g,saveDrawInfo:function(e,t,r,n){function a(e){return e?n.id(e):0}function i(e,t){Object.keys(t).forEach((function(t){e[n.id(t)]=!0}))}g(e),e._fragId=a(e.static.frag),e._vertId=a(e.static.vert);var o=e._uniformSet={};i(o,t.static),i(o,t.dynamic);var f=e._attributeSet={};i(f,r.static),i(f,r.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,r){e.texture?u(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):u(e.renderbuffer._renderbuffer.format,r,"unsupported renderbuffer format for attachment")},guessCommand:m,texture2D:function(e,t,r){var n,a=t.width,i=t.height,f=t.channels;o(a>0&&a<=r.maxTextureSize&&i>0&&i<=r.maxTextureSize,"invalid texture shape"),e.wrapS===y&&e.wrapT===y||o(k(a)&&k(i),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==a&&1!==i&&o(9984!==e.minFilter&&9986!==e.minFilter&&9985!==e.minFilter&&9987!==e.minFilter,"min filter requires mipmap"):(o(k(a)&&k(i),"texture must be a square power of 2 to support mipmapping"),o(t.mipmask===(a<<1)-1,"missing or incomplete mipmap data")),5126===t.type&&(r.extensions.indexOf("oes_texture_float_linear")<0&&o(9728===e.minFilter&&9728===e.magFilter,"filter not supported, must enable oes_texture_float_linear"),o(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(n=0;n<16;++n)if(u[n]){var s=a>>n,c=i>>n;o(t.mipmask&1<<n,"missing mipmap data");var l=u[n];o(l.width===s&&l.height===c,"invalid shape for mip images"),o(l.format===t.format&&l.internalformat===t.internalformat&&l.type===t.type,"incompatible type for mip image"),l.compressed||(l.data?o(l.data.byteLength===s*c*Math.max(w(l.type,f),l.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):l.element||l.copy)}else e.genMipmaps||o(0==(t.mipmask&1<<n),"extra mipmap data");t.compressed&&o(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,r,n){var a=e.width,i=e.height,f=e.channels;o(a>0&&a<=n.maxTextureSize&&i>0&&i<=n.maxTextureSize,"invalid texture shape"),o(a===i,"cube map must be square"),o(t.wrapS===y&&t.wrapT===y,"wrap mode not supported by cube map");for(var u=0;u<r.length;++u){var s=r[u];o(s.width===a&&s.height===i,"inconsistent cube map face shape"),t.genMipmaps&&(o(!s.compressed,"can not generate mipmap for compressed textures"),o(1===s.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=s.images,l=0;l<16;++l){var p=c[l];if(p){var d=a>>l,m=i>>l;o(s.mipmask&1<<l,"missing mipmap data"),o(p.width===d&&p.height===m,"invalid shape for mip images"),o(p.format===e.format&&p.internalformat===e.internalformat&&p.type===e.type,"incompatible type for mip image"),p.compressed||(p.data?o(p.data.byteLength===d*m*Math.max(w(p.type,f),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):p.element||p.copy)}}}}})},114:e=>{e.exports="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},914:(e,t,r)=>{var n=r(207);function a(e){return Array.prototype.slice.call(e)}function i(e){return a(e).join("")}e.exports=function(){var e=0,t=[],r=[];function o(){var t=[],r=[];return n((function(){t.push.apply(t,a(arguments))}),{def:function(){var n="v"+e++;return r.push(n),arguments.length>0&&(t.push(n,"="),t.push.apply(t,a(arguments)),t.push(";")),n},toString:function(){return i([r.length>0?"var "+r+";":"",i(t)])}})}function f(){var e=o(),t=o(),r=e.toString,i=t.toString;function f(r,n){t(r,n,"=",e.def(r,n),";")}return n((function(){e.apply(e,a(arguments))}),{def:e.def,entry:e,exit:t,save:f,set:function(t,r,n){f(t,r),e(t,r,"=",n,";")},toString:function(){return r()+i()}})}var u=o(),s={};return{global:u,link:function(n){for(var a=0;a<r.length;++a)if(r[a]===n)return t[a];var i="g"+e++;return t.push(i),r.push(n),i},block:o,proc:function(e,t){var r=[];function a(){var e="a"+r.length;return r.push(e),e}t=t||0;for(var o=0;o<t;++o)a();var u=f(),c=u.toString;return s[e]=n(u,{arg:a,toString:function(){return i(["function(",r.join(),"){",c(),"}"])}})},scope:f,cond:function(){var e=i(arguments),t=f(),r=f(),o=t.toString,u=r.toString;return n(t,{then:function(){return t.apply(t,a(arguments)),this},else:function(){return r.apply(r,a(arguments)),this},toString:function(){var t=u();return t&&(t="else{"+t+"}"),i(["if(",e,"){",o(),"}",t])}})},compile:function(){var e=['"use strict";',u,"return {"];Object.keys(s).forEach((function(t){e.push('"',t,'":',s[t].toString(),",")})),e.push("}");var n=i(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,t.concat(n)).apply(null,r)}}}},207:e=>{e.exports=function(e,t){for(var r=Object.keys(t),n=0;n<r.length;++n)e[r[n]]=t[r[n]];return e}},783:(e,t,r)=>{var n=r(809);e.exports=function(e){return Array.isArray(e)||n(e)}},533:(e,t,r)=>{var n=r(809);e.exports=function(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||n(e.data))}},809:(e,t,r)=>{var n=r(486);e.exports=function(e){return Object.prototype.toString.call(e)in n}},954:e=>{e.exports=function(e,t){for(var r=Array(e),n=0;n<e;++n)r[n]=t(n);return r}},256:(e,t,r)=>{var n=r(954)(8,(function(){return[]}));function a(e){var t,r;return t=(e>65535)<<4,t|=r=((e>>>=t)>255)<<3,t|=r=((e>>>=r)>15)<<2,(t|=r=((e>>>=r)>3)<<1)|(e>>>=r)>>1}function i(e){var t=function(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}(e),r=n[a(t)>>2];return r.length>0?r.pop():new ArrayBuffer(t)}function o(e){n[a(e.byteLength)>>2].push(e)}e.exports={alloc:i,free:o,allocType:function(e,t){var r=null;switch(e){case 5120:r=new Int8Array(i(t),0,t);break;case 5121:r=new Uint8Array(i(t),0,t);break;case 5122:r=new Int16Array(i(2*t),0,t);break;case 5123:r=new Uint16Array(i(2*t),0,t);break;case 5124:r=new Int32Array(i(4*t),0,t);break;case 5125:r=new Uint32Array(i(4*t),0,t);break;case 5126:r=new Float32Array(i(4*t),0,t);break;default:return null}return r.length!==t?r.subarray(0,t):r},freeType:function(e){o(e.buffer)}}},755:e=>{"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?e.exports={next:function(e){return requestAnimationFrame(e)},cancel:function(e){return cancelAnimationFrame(e)}}:e.exports={next:function(e){return setTimeout(e,16)},cancel:clearTimeout}},856:(e,t,r)=>{var n=r(256),a=new Float32Array(1),i=new Uint32Array(a.buffer);e.exports=function(e){for(var t=n.allocType(5123,e.length),r=0;r<e.length;++r)if(isNaN(e[r]))t[r]=65535;else if(e[r]===1/0)t[r]=31744;else if(e[r]===-1/0)t[r]=64512;else{a[0]=e[r];var o=i[0],f=o>>>31<<15,u=(o<<1>>>24)-127,s=o>>13&1023;if(u<-24)t[r]=f;else if(u<-14){var c=-14-u;t[r]=f+(s+1024>>c)}else t[r]=u>15?f+31744:f+(u+15<<10)+s}return t}},326:e=>{e.exports=function(e){return Object.keys(e).map((function(t){return e[t]}))}},218:(e,t,r)=>{var n=r(343),a=r(207);function i(e){return"string"==typeof e?e.split():(n(Array.isArray(e),"invalid extension array"),e)}function o(e){return"string"==typeof e?(n("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}e.exports=function(e){var t,r,f,u,s,c=e||{},l={},p=[],d=[],m="undefined"==typeof window?1:window.devicePixelRatio,h=!1,b=function(e){e&&n.raise(e)},g=function(){};if("string"==typeof c?(n("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(c),n(t,"invalid query string for element")):"object"==typeof c?"string"==typeof(s=c).nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?t=c:function(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}(c)?f=(u=c).canvas:(n.constructor(c),"gl"in c?u=c.gl:"canvas"in c?f=o(c.canvas):"container"in c&&(r=o(c.container)),"attributes"in c&&(l=c.attributes,n.type(l,"object","invalid context attributes")),"extensions"in c&&(p=i(c.extensions)),"optionalExtensions"in c&&(d=i(c.optionalExtensions)),"onDone"in c&&(n.type(c.onDone,"function","invalid or missing onDone callback"),b=c.onDone),"profile"in c&&(h=!!c.profile),"pixelRatio"in c&&(m=+c.pixelRatio,n(m>0,"invalid pixel ratio"))):n.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?f=t:r=t),!u){if(!f){n("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var v=function(e,t,r){var n=document.createElement("canvas");function i(){var t=window.innerWidth,i=window.innerHeight;if(e!==document.body){var o=e.getBoundingClientRect();t=o.right-o.left,i=o.top-o.bottom}n.width=r*t,n.height=r*i,a(n.style,{width:t+"px",height:i+"px"})}return a(n.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(n),e===document.body&&(n.style.position="absolute",a(e.style,{margin:0,padding:0})),window.addEventListener("resize",i,!1),i(),{canvas:n,onDestroy:function(){window.removeEventListener("resize",i),e.removeChild(n)}}}(r||document.body,0,m);if(!v)return null;f=v.canvas,g=v.onDestroy}u=function(e,t){function r(r){try{return e.getContext(r,t)}catch(e){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}(f,l)}return u?{gl:u,canvas:f,container:r,extensions:p,optionalExtensions:d,pixelRatio:m,profile:h,onDone:b,onDestroy:g}:(g(),b("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},543:(e,t,r)=>{var n=r(343),a=r(207),i=r(414),o=r(755),f=r(114),u=r(927),s=r(218),c=r(75),l=r(12),p=r(661),d=r(80),m=r(315),h=r(737),b=r(498),g=r(18),v=r(699),y=r(229),x=r(283),w=r(827),k=r(249),A="webglcontextlost",_="webglcontextrestored";function S(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}e.exports=function(e){var t=s(e);if(!t)return null;var r=t.gl,E=r.getContextAttributes(),j=c(r,t);if(!j)return null;var T=u(),D=w(),O=j.extensions,C=k(r,O),M=f(),z=r.drawingBufferWidth,F=r.drawingBufferHeight,P={tick:0,time:0,viewportWidth:z,viewportHeight:F,framebufferWidth:z,framebufferHeight:F,drawingBufferWidth:z,drawingBufferHeight:F,pixelRatio:t.pixelRatio},B=l(r,O),L=p(r,D,t),I=d(r,O,L,D),R=g(r,O,B,L,T),W=v(r,T,D,t),N=m(r,O,B,(function(){U.procs.poll()}),P,D,t),q=h(r,O,B,D,t),H=b(r,O,B,N,q,D),U=x(r,T,O,B,L,I,N,H,{},R,W,{elements:null,primitive:4,count:-1,offset:0,instances:-1},P,C,t),G=y(r,H,U.procs.poll,P,E,O),Q=U.next,V=r.canvas,Y=[],$=null;function J(){if(0===Y.length)return C&&C.update(),void($=null);$=o.next(J),re();for(var e=Y.length-1;e>=0;--e){var t=Y[e];t&&t(P,null,0)}r.flush(),C&&C.update()}function X(){$&&(o.cancel(J),$=null)}function K(e){}function Z(e){}function ee(e){function t(e){var t={},r={};return Object.keys(e).forEach((function(n){var a=e[n];i.isDynamic(a)?r[n]=i.unbox(a,n):t[n]=a})),{dynamic:r,static:t}}n(!!e,"invalid args to regl({...})"),n.type(e,"object","invalid args to regl({...})");var r=t(e.context||{}),o=t(e.uniforms||{}),f=t(e.attributes||{}),u=t(function(e){var t=a({},e);function r(e){if(e in t){var r=t[e];delete t[e],Object.keys(r).forEach((function(n){t[e+"."+n]=r[n]}))}}return delete t.uniforms,delete t.attributes,delete t.context,r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),t}(e)),s={gpuTime:0,cpuTime:0,count:0},c=U.compile(u,f,o,r,s),l=c.draw,p=c.batch,d=c.scope,m=[];return a((function(e,t){var r;if("function"==typeof e)return d.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e){for(r=0;r<e;++r)d.call(this,null,t,r);return}if(Array.isArray(e)){for(r=0;r<e.length;++r)d.call(this,e[r],t,r);return}return d.call(this,e,t,0)}if("number"==typeof e){if(e>0)return p.call(this,function(e){for(;m.length<e;)m.push(null);return m}(0|e),0|e)}else{if(!Array.isArray(e))return l.call(this,e);if(e.length)return p.call(this,e,e.length)}}),{stats:s})}function te(){var e=Q.viewport,t=Q.scissor_box;e[0]=e[1]=t[0]=t[1]=0,P.viewportWidth=P.framebufferWidth=P.drawingBufferWidth=e[2]=t[2]=r.drawingBufferWidth,P.viewportHeight=P.framebufferHeight=P.drawingBufferHeight=e[3]=t[3]=r.drawingBufferHeight}function re(){P.tick+=1,P.time=(f()-M)/1e3,te(),U.procs.poll()}function ne(){te(),U.procs.refresh(),C&&C.update()}V&&(V.addEventListener(A,K,!1),V.addEventListener(_,Z,!1)),ne();var ae=a(ee,{clear:function(e){n("object"==typeof e&&e,"regl.clear() takes an object as input");var t=0;U.procs.poll();var a=e.color;a&&(r.clearColor(+a[0]||0,+a[1]||0,+a[2]||0,+a[3]||0),t|=16384),"depth"in e&&(r.clearDepth(+e.depth),t|=256),"stencil"in e&&(r.clearStencil(0|e.stencil),t|=1024),n(!!t,"called regl.clear with no buffer specified"),r.clear(t)},prop:i.define.bind(null,1),context:i.define.bind(null,2),this:i.define.bind(null,3),draw:ee({}),buffer:function(e){return L.create(e,34962)},elements:I.create,texture:N.create2D,cube:N.createCube,renderbuffer:q.create,framebuffer:H.create,framebufferCube:H.createCube,attributes:E,frame:function(e){return n.type(e,"function","regl.frame() callback must be a function"),Y.push(e),!$&&Y.length>0&&($=o.next(J)),{cancel:function(){var t=S(Y,e);n(t>=0,"cannot cancel a frame twice"),Y[t]=function e(){var t=S(Y,e);Y[t]=Y[Y.length-1],Y.length-=1,Y.length<=0&&X()}}}},limits:B,hasExtension:function(e){return B.extensions.indexOf(e.toLowerCase())>=0},read:G,destroy:function(){Y.length=0,X(),V&&(V.removeEventListener(A,K),V.removeEventListener(_,Z)),W.clear(),H.clear(),q.clear(),N.clear(),I.clear(),L.clear(),C&&C.clear(),t.onDestroy()},_gl:r,_refresh:ne,poll:function(){re(),C&&C.update()},stats:D});return t.onDone(null,ae),ae}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{var e=n(878);const t=(e,t)=>e.reduce(((e,r,n)=>(n%t==0?e.push([r]):e[e.length-1].push(r))&&e),[]),r=((r,n)=>{let a=new Int8Array(12e3).fill(0).map((e=>Math.random()>=.7?1:0));const i=e(t(a,r),{root:document.body,size:4,padding:1});return()=>{a=((e,t)=>e.map(((r,n)=>{const a=[n-t-1,n-t,n-t+1,n-1,n+1,n+t-1,n+t,n+t+1].filter((t=>null!=e[t]&&1==e[t])).length;return 1==r?2==a||3==a?1:0:3==a?1:0})))(a,r),i.update(t(a,r))}})(150),a=()=>{r(),window.requestAnimationFrame(a)};a()})()})();